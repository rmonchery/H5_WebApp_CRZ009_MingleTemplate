var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},Odin;!function(e){var t=function(){function e(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this.major=0,this.minor=0,this.patch=0,this.major=e,this.minor=t,this.patch=n,this.full=e+"."+t+"."+n}return e}();e.Version=t;var n=function(){function e(){}return e.remove=function(e,t){var n=$.inArray(t,e);n>=0&&e.splice(n,1)},e.removeByProperty=function(e,t,n){for(var i=0;i<e.length;i++)if(e[i][t]==n)return e.splice(i,1),!0;return!1},e.indexByProperty=function(e,t,n){for(var i=0;i<e.length;i++)if(e[i][t]==n)return i;return-1},e.itemByProperty=function(e,t,n){var i=this.indexByProperty(e,t,n);return i>=0?e[i]:null},e.containsByProperty=function(e,t,n){return this.indexByProperty(e,t,n)>=0},e.contains=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1},e.last=function(e){return e&&e.length>0?e[e.length-1]:null},e}();e.ArrayUtil=n;var i=function(){function e(){}return e.addAppender=function(t){e.appenders.push(t)},e.removeAppender=function(t){n.remove(e.appenders,t)},e.getTime=function(){var e=new Date,t=e.getHours(),n=e.getMinutes(),i=e.getSeconds(),r=e.getMilliseconds(),o=(t<10?"0":"")+t+":"+(n<10?"0":"")+n+":"+(i<10?"0":"")+i+","+(r<10?"00":(r<100?"0":"")+r);return o},e.getLogEntry=function(t,n,i){var r="["+e.getTime()+"] "+this.prefixes[t]+" "+n;return i&&(r+=" "+i.message,i.stack&&(r+=" "+i.stack)),r},e.log=function(t,n,i,r){if(n<=t){if(e.isConsoleLogEnabled&&window.console){var o=e.getLogEntry(n,i,r);n<=1?console.error(o):2==n?console.warn(o):3==n?console.info(o):console.log(o)}if(e.appenders)for(var a=0;a<e.appenders.length;a++)try{e.appenders[a](n,i,r)}catch(e){}}},e.setDefault=function(){this.level=this.levelInfo},e.fatal=function(e,t){this.log(this.level,this.levelFatal,e,t)},e.error=function(e,t){this.log(this.level,this.levelError,e,t)},e.warning=function(e,t){this.log(this.level,this.levelWarning,e,t)},e.info=function(e,t){this.log(this.level,this.levelInfo,e,t)},e.isDebug=function(){return this.level>=this.levelDebug},e.setDebug=function(){this.level=this.levelDebug},e.debug=function(e,t){this.log(this.level,this.levelDebug,e,t)},e.isTrace=function(){return this.level>=this.levelTrace},e.setTrace=function(){this.level=this.levelTrace},e.trace=function(e,t){this.log(this.level,this.levelTrace,e,t)},e.levelFatal=0,e.levelError=1,e.levelWarning=2,e.levelInfo=3,e.levelDebug=4,e.levelTrace=5,e.level=e.levelInfo,e.isConsoleLogEnabled=!0,e.prefixes=["[FATAL]","[ERROR]","[WARNING]","[INFO]","[DEBUG]","[TRACE]"],e.appenders=[],e}();e.Log=i;var r=function(){function e(){}return e.getLocaleSeparator=function(){var e=1.1,t=e.toLocaleString().substring(1,2);return t},e.getDefaultOptions=function(){return e.defaultOptions},e.setDefaultOptions=function(t){e.defaultOptions=t,t.separator&&(e.defaultSeparator=t.separator)},e.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.getInt=function(e,t){if(void 0===t&&(t=0),e)try{return parseInt(e)}catch(e){}return t},e.format=function(t,n){var i=t.toString();if(""===i)return i;var r=n?n.separator:e.defaultOptions.separator;return r||(r=e.defaultSeparator),i=i.replace(".",r)},e.pad=function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},e.hasOnlyIntegers=function(e){if(!e)return!1;for(var t="1234567890",n=0;n<e.length;n++)if(t.indexOf(e.charAt(n))==-1)return!1;return!0},e.defaultSeparator=e.getLocaleSeparator(),e.defaultOptions={separator:e.defaultSeparator},e}();e.NumUtil=r;var o=function(){function e(){}return e.isNullOrEmpty=function(e){return!e},e.startsWith=function(e,t){return!!s.hasValue(e)&&0==e.indexOf(t)},e.endsWith=function(e,t){return null!=e&&e.indexOf(t,e.length-t.length)!==-1},e.trimEnd=function(e){return e.replace(/\s+$/,"")},e.format=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n="missing";try{n=e[0];var r=Array.prototype.slice.call(e,1);n=n.replace(/{(\d+)}/g,function(){var e=r[arguments[1]];return"undefined"!=typeof e?e:arguments[0]})}catch(t){i.error("Failed to format string. Args: "+e)}return n},e}();e.StringUtil=o;var a=function(){function e(){}return e.isDate=function(e){return e instanceof Date&&!isNaN(e.valueOf())},e}();e.DateUtil=a;var s=function(){function e(){}return e.getBoolean=function(e,t){return void 0===t&&(t=!1),e&&e.length>0?"t"===e[0].toLowerCase():t},e.getUuid=function(e){return e+(65536*(1+Math.random())|0).toString(16).substring(1)+(65536*(1+Math.random())|0).toString(16).substring(1)},e.hasValue=function(e){return"undefined"!=typeof e&&null!=e},e.isUndefined=function(e){return"undefined"==typeof e},e.random=function(t){void 0===t&&(t=16);for(var n=e.chars,i="",r=0;r<t;r++){var o=Math.floor(Math.random()*n.length);i+=n.substring(o,o+1)}return i},e.isIframe=function(){try{return window.self!==window.top}catch(e){return!0}},e.chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",e}();e.Util=s;var l=function(){function e(){}return e.http="HTTP",e.parse="PARSE",e}();e.ErrorTypes=l;var c=function(){function e(){}return e.prototype.hasError=function(){var e=this;return!!(e.errorMessage||e.errorCode||e.error)},e}();e.ErrorState=c;var u=function(e){function t(){e.call(this)}return __extends(t,e),t.prototype.get=function(e){var t=this[e];return t?t:e},t.prototype.format=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];if(e.length<2)throw"At least two parameters are required";var n=this.get(e[0]);return e[0]=n,o.format(e)},t}(c);e.Language=u;var d=function(){function e(){this.handlers=[]}return e.prototype.on=function(e){this.handlers.push(e)},e.prototype.off=function(e){this.handlers=this.handlers.filter(function(t){return t!==e})},e.prototype.raise=function(e){this.handlers&&this.handlers.slice(0).forEach(function(t){return t(e)})},e}();e.InstanceEvent=d,function(e){e[e.Busy=1]="Busy",e[e.Active=2]="Active"}(e.ComponentState||(e.ComponentState={}));var p=(e.ComponentState,function(){function e(){}return e.getApplication=function(t){return t[e.app]},e.setApplication=function(t,n){t[e.app]=n},e.getPath=function(){return e.path},e.setPath=function(t){e.path=t,i.info("[Odin.Framework] Path changed to: "+t)},e.path="odin",e.app="odinApp",e.version=new t(1,1,1),e}());e.Framework=p;var h=function(){function e(){this.startupServiceName="odinStartupService"}return e.prototype.onStart=function(){},e.prototype.onReady=function(e){e.setReady()},e.prototype.onError=function(e){e.showErrorMessage(this.name)},e.prototype.addUrlOverride=function(e,t,n){var i={host:t,url:n},r=this.urlOverrides;r||(this.urlOverrides=r={}),r[e]=i},e.prototype.getStartupOptions=function(){var e={name:this.name,description:this.description,version:this.version,id:this.id},t={application:e,frameworkPath:this.frameworkPath,languageOptions:this.languageOptions,urlOverrides:this.urlOverrides};return t},e.prototype.validate=function(){if(!this.module)throw"The module property is not set";if(!this.name)throw"The name property is not set"},e.prototype.startService=function(e){var t=this;this.startupService=e;var n=this.getStartupOptions();e.start(n).then(function(e){t.onReady(e)},function(e){t.onError(e)})},e.prototype.onRun=function(){var e=this;this.module.run([this.startupServiceName,function(t){e.startService(t)}])},e.prototype.start=function(){this.onStart(),this.validate(),this.onRun()},e}();e.ApplicationBase=h;var f=function(){function e(e){this.$locale=e,this.dateFormat="yyyy-MM-dd",this.datetimeFormats=e.DATETIME_FORMATS,this.monthNames=this.datetimeFormats.MONTH.concat(this.datetimeFormats.SHORTMONTH),this.dayNames=this.datetimeFormats.DAY.concat(this.datetimeFormats.SHORTDAY)}return e.add=function(t){t.service("odinFormatService",e)},e.prototype.getDecimalSeparator=function(){return r.getDefaultOptions().separator},e.prototype.setDecimalSeparator=function(e){var t=r.getDefaultOptions();t.separator=e,r.setDefaultOptions(t)},e.prototype.setDateFormat=function(e){this.dateFormat=e},e.prototype.getDateFormat=function(){return this.dateFormat},e.prototype.parseDate=function(e,t){try{if(e+="",t||(t=this.dateFormat),!t.length)return new Date(e);this.datetimeFormats[t]&&(t=this.datetimeFormats[t]);for(var n=new Date,i=0,r=0,o="",a=n.getFullYear(),s=n.getMonth()+1,l=n.getDate(),c=0,u=0,d=0,p=0,h="am",f=0,g=!1;r<t.length;){o=t.charAt(r);var v="";if("'"!=t.charAt(r)){for(;t.charAt(r)==o&&r<t.length;)v+=t.charAt(r++);if("yyyy"==v||"yy"==v||"y"==v){var m,y;"yyyy"==v&&(m=4,y=4),"yy"==v&&(m=2,y=2),"y"==v&&(m=2,y=4);var b=this.getInteger(e,i,m,y);if(a=parseInt(b),isNaN(a))throw"Invalid year";i+=b.length,2==b.length&&(a=a>70?1900+(a-0):2e3+(a-0))}else if("MMMM"===v||"MMM"==v){s=0;for(var S=0;S<this.monthNames.length;S++){var C=this.monthNames[S];if(e.substring(i,i+C.length).toLowerCase()==C.toLowerCase()){s=S+1,s>12&&(s-=12),i+=C.length;break}}if(s<1||s>12)throw"Invalid month"}else if("EEEE"==v||"EEE"==v)for(var x=0;x<this.dayNames.length;x++){var I=this.dayNames[x];if(e.substring(i,i+I.length).toLowerCase()==I.toLowerCase()){i+=I.length;break}}else if("MM"==v||"M"==v){var w=this.getInteger(e,i,v.length,2);if(s=parseInt(w),isNaN(s)||s<1||s>12)throw"Invalid month";i+=w.length}else if("dd"==v||"d"==v){var E=this.getInteger(e,i,v.length,2);if(l=parseInt(E),isNaN(l)||l<1||l>31)throw"Invalid date";i+=E.length}else if("HH"==v||"H"==v){var O=this.getInteger(e,i,v.length,2);if(null===c||c<0||c>23)throw"Invalid hours";i+=O.length}else if("hh"==v||"h"==v){var M=this.getInteger(e,i,v.length,2);if(null===c||c<1||c>12)throw"Invalid hours";i+=M.length}else if("mm"==v||"m"==v){var L=this.getInteger(e,i,v.length,2);if(null===u||u<0||u>59)throw"Invalid minutes";i+=L.length}else if("ss"==v||"s"==v){var D=this.getInteger(e,i,v.length,2);if(d=parseInt(D),isNaN(d)||d<0||d>59)throw"Invalid seconds";i+=D.length}else if("sss"===v){var p=parseInt(this.getInteger(e,i,3,3));if(isNaN(p)||p<0||p>999)throw"Invalid milliseconds";i+=3}else if("a"==v){if("am"==e.substring(i,i+2).toLowerCase())h="AM";else{if("pm"!=e.substring(i,i+2).toLowerCase())throw"Invalid AM/PM";h="PM"}i+=2}else if("Z"==v){if(g=!0,"Z"===e[i])f=0,i+=1;else if(":"===e[i+3]){var A=e.substring(i,i+6);f=60*parseInt(A.substr(0,3),10)+parseInt(A.substr(4,2),10),i+=6}else{var A=e.substring(i,i+5);f=60*parseInt(A.substr(0,3),10)+parseInt(A.substr(3,2),10),i+=5}if(f>720||f<-720)throw"Invalid timezone"}else{if(e.substring(i,i+v.length)!=v)throw"Pattern value mismatch";i+=v.length}}else{for(;"'"!=t.charAt(++r)&&r<t.length;)v+=t.charAt(r);if(e.substring(i,i+v.length)!=v)throw"Pattern value mismatch";i+=v.length,r++}}if(i!=e.length)throw"Pattern value mismatch";if(2==s)if(a%4===0&&a%100!==0||a%400===0){if(l>29)throw"Invalid date"}else if(l>28)throw"Invalid date";if((4==s||6==s||9==s||11==s)&&l>30)throw"Invalid date";c<12&&"PM"==h?c+=12:c>11&&"AM"==h&&(c-=12);var B=new Date(a,s-1,l,c,u,d,p);return g?new Date(B.getTime()-6e4*(f+B.getTimezoneOffset())):B}catch(e){return}},e.prototype.getInteger=function(e,t,n,i){for(var o=i;o>=n;o--){var a=e.substring(t,t+o);if(r.hasOnlyIntegers(a))return a}return null},e.$inject=["$locale"],e}();e.FormatService=f;var g=function(){function t(e){this.q=e,this.resultCache={},this.providerDictionary={},this.awaitingProviderDictionary={}}return t.add=function(e){e.service("odinDataProviderService",t)},t.prototype.register=function(t,n){if(null!=this.providerDictionary[t])throw"The key must be unique. Key "+t+" already exists.";this.providerDictionary[t]=n,e.Log.debug("Registered provider for key: "+t),this.awaitingProviderDictionary[t]&&this.get(t,this.awaitingProviderDictionary[t].options)},t.prototype.get=function(t,n){var i=this,r=this.awaitingProviderDictionary[t],o=r?r.deferred:this.q.defer(),a=this.resultCache[t];if(null==a)try{var s=this.providerDictionary[t];null!=s?(e.Log.debug("Start fetching data for key: "+t),s.get(n).then(function(n){n.hasError()&&e.Log.debug("Response for key: "+t+" has errors: "+n.errorMessage),i.resultCache[t]=n,o.resolve(n)},function(n){n.hasError()&&e.Log.debug("Response for key "+t+" has errors: "+n.errorMessage)})):(e.Log.debug("Key "+t+" not yet registered, awaiting registration."),this.awaitingProviderDictionary[t]={options:n,deferred:o})}catch(n){e.Log.warning("Something went wrong when fetching data for key: "+t)}else o.resolve(a);return o.promise},t.$inject=["$q"],t}();e.DataProviderService=g;var v=function(){function e(){}return e.add=function(e){var t=this;e.directive("odinDataProvider",["$rootScope","odinDataProviderService",function(e,n){return t.create(e,n)}])},e.create=function(e,t){return{restrict:"E",link:function(e,n,i){var r=i.key,o=i.propertyName||r;t.get(r).then(function(t){t.hasError()||(e[o]=t.items)})}}},e}();e.DataProviderDirective=v}(Odin||(Odin={}));var Odin;!function(e){var t=function(){function e(){}return e.cacheTemplatesInModule=function(){angular.module("odin").run(["$templateCache",function(e){e.put("odin/partials/filterHeader.html",'<div class="ngHeaderSortColumn{{col.headerClass}}" ng-syle="{\\&quot;cursor\\&quot;: col.cursor}" ng-class="{\\&quot;ngSorted\\&quot;: !noSortVisible}"><div ng-click="col.sort($event)" ng-class="\\&quot;colt\\&quot; + col.index" class="ngHeaderText">{{col.displayName}}</div><div class="ngSortButtonDown" ng-show="col.showSortButtonDown()"></div><div class="ngSortButtonUp" ng-show="col.showSortButtonUp()"></div><div class="ngSortPriority">{{col.sortPriority}}</div><div ng-class="{ngPinnedIcon: col.pinned, ngUnPinnedIcon: !col.pinned}" ng-click="togglePin(col)" ng-show="col.pinnable"></div></div><input type="text" ng-click="stopClickProp($event)" placeholder="Filter..." ng-model="col.filterText" ng-style="{\\&quot;width\\&quot; : col.width - 14 + \\&quot;px\\&quot;}"><div ng-show="col.resizable" class="ngHeaderGrip" ng-click="col.gripClick($event)" ng-mousedown="col.gripOnMouseDown($event)"></div>'),e.put("odin/partials/genericBrowse.html",'<div class="modal-header"><button class="close" type="button" ng-click="cancel()">×</button><h3>{{options.header}}</h3></div><div class="modal-body"><p>{{options.message}}</p><div ng-include="options.templateUrl"></div></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">{{lang.OK}}</button> <button class="btn" ng-click="cancel()">{{lang.Cancel}}</button></div>'),e.put("odin/partials/gridBrowse.html",'<div class="modal-header"><button class="close" type="button" ng-click="cancel()">×</button><h3>{{options.header}}</h3></div><div class="modal-body"><div class="odin-position-r"><odin-busy-indicator ng-show="odinBusy"></odin-busy-indicator><div class="container-fluid"><div>{{options.message}}</div><div style="width: 480px" ui-grid="gridOptions" ui-grid-selection ui-grid-resize-columns></div></div></div></div><div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">{{lang.OK}}</button> <button class="btn" ng-click="cancel()">{{lang.Cancel}}</button></div>'),e.put("odin/partials/modalMessage.html",'<div class="modal-header"><button class="close" type="button" ng-click="options.close()">×</button><h3>{{options.header}}</h3></div><div class="modal-body"><p>{{options.message}}</p></div><div class="modal-footer"><button class="btn btn-primary" ng-click="options.primary()">{{options.primaryText}}</button> <button class="btn" ng-click="options.secondary()" ng-show="options.showSecondary">{{options.secondaryText}}</button> <button class="btn" ng-click="options.cancel()" ng-show="options.showCancel">{{options.cancelText}}</button></div>')}])},e}();e.Templates=t}(Odin||(Odin={}));var Odin;!function(e){var t=function(){function e(e,t){this.$rootScope=e,this.$timeout=t}return e.prototype.focusById=function(e){angular.element("#"+e).trigger("focus")},e.prototype.focusByName=function(e){var t=this;this.$timeout(function(){t.$rootScope.$broadcast("odinFocusOn",e)})},e.add=function(t){t.factory("odinFocus",["$rootScope","$timeout",function(t,n){return new e(t,n)}]),t.directive("odinFocusAuto",function(e){return{restrict:"AC",link:function(t,n){e(function(){n[0].focus()},0)}}}),t.directive("odinFocusOn",function(){return function(e,t,n){e.$on("odinFocusOn",function(e,i){i===n.odinFocusOn&&t[0].focus()})}}),t.directive("odinFocus",function(e,t){return{restrict:"A",link:function(t,n,i){t.$watch(i.odinFocus,function(e,t){e&&n[0].focus()}),n.bind("blur",function(n){e(function(){t.$apply(i.odinFocus+"=false")},0)}),n.bind("focus",function(n){e(function(){t.$apply(i.odinFocus+"=true")},0)})}}})},e}();e.FocusDirective=t}(Odin||(Odin={}));var Odin;!function(e){!function(e){e[e.Information=0]="Information",e[e.Warning=1]="Warning",e[e.Error=2]="Error"}(e.MessageType||(e.MessageType={}));var t=e.MessageType;!function(e){e[e.Ok=1]="Ok",e[e.OkCancel=2]="OkCancel",e[e.YesNo=3]="YesNo",e[e.YesNoCancel=4]="YesNoCancel"}(e.DialogButtons||(e.DialogButtons={}));var n=e.DialogButtons;!function(e){e[e.Ok=1]="Ok",e[e.Cancel=2]="Cancel",e[e.Yes=3]="Yes",e[e.No=4]="No"}(e.DialogResult||(e.DialogResult={}));var i=e.DialogResult,r=function(){function e(){this.message=null,this.header=null,this.messageType=t.Information,this.messageCode=null}return e}();e.Message=r;var o=function(){function e(){this.statusBarName="odinStatusBar",this.defaultHeader=null}return e}(),a=function(){function n(e){angular.copy(e,this),this.timestamp=new Date,this.type||(this.type=t.Information)}return n.prototype.formatTime=function(){return this.timestamp.getHours()+":"+e.NumUtil.pad(this.timestamp.getMinutes(),2)},n}(),s=function(){function e(e,t,n){var i=this;this.scope=e,this.messageService=t,this.timeoutService=n,this.items=[],this.lastMessage=null,this.isStatusVisible=!0,this.isCollapsed=!0,this.clearMessageInterval=5e3,t.messageAdded().on(function(e){return i.addMessageInternal(e)})}return e.prototype.addMessageInternal=function(e){var n=this,i=new a(e);this.clearMessageInterval>0&&e.type!=t.Error?(this.clearPromise&&this.timeoutService.cancel(this.clearPromise),this.clearPromise=this.timeoutService(function(){return n.onTimeout()},this.clearMessageInterval)):this.clearMessageInterval>0&&e.type==t.Error&&this.clearPromise&&this.timeoutService.cancel(this.clearPromise),this.lastMessage=i,this.items.push(i)},e.prototype.removeAt=function(e){if(e||0==e){var t=this.items.splice(this.items.length-1-e,1);t[0]==this.lastMessage&&(this.lastMessage=null)}this.isCollapsed=0==this.items.length},e.prototype.onTimeout=function(){this.lastMessage=null,this.clearPromise=null},e.prototype.addMessage=function(e){this.addMessageInternal({message:e})},e.prototype.clear=function(){this.isCollapsed=!0,this.items=[],this.lastMessage=null},e.$inject=["$scope","odinMessageService","$timeout"],e}(),l=function(){function r(i,r,a,s){this.rootScope=i,this.modal=r,this.q=a,this.languageService=s,this.defaultServiceOptions=new o,this.messageEvent=new e.InstanceEvent,this.defaultSettings={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:e.BrowseConstants.modalMessageTemplate},this.defaultOptions={type:t.Information,buttons:n.Ok,primaryText:"OK",cancelText:"Cancel"}}return r.add=function(e){e.service("odinMessageService",r),e.controller("odinStatusBarCtrl",s),e.directive("odinStatusbar",function(){return{restrict:"E",replace:!0,template:"<div ng-controller='odinStatusBarCtrl as ctrl' id='odin-statusbar' class='odin-statusbar' uib-collapse='!ctrl.isStatusVisible'><table class='table odin-statusbar-header' ng-disabled='ctrl.items.length==0' ng-click='(ctrl.items.length > 0) && (ctrl.isCollapsed=!ctrl.isCollapsed)' ng-model='ctrl.isCollapsed'><tbody><tr><td><span class='odin-statusbar-message' ng-class='{\"0\": \"information\", \"1\": \"warning\", \"2\":\"error\"}[ctrl.lastMessage.type]'>{{ctrl.lastMessage.message}}</span></td><td class='odin-width-xs'><button type='button' ng-disabled='ctrl.items.length==0' class='close'><span class='btn-xs glyphicon' ng-class='{\"true\": \"glyphicon-chevron-up\", \"false\": \"glyphicon-chevron-down\", \"undefined\":\"glyphicon-chevron-down\"}[ctrl.isCollapsed]'></span></button></td></tr></tbody></table><div uib-collapse='ctrl.isCollapsed'><div class='odin-statusbar-content'><table class='table'><tbody><tr ng-repeat='item in ctrl.items | orderBy:\"timestamp\":true'><td><span class='odin-statusbar-message' ng-class='{\"0\": \"information\", \"1\": \"warning\", \"2\":\"error\"}[item.type]'>{{item.message}}</span></td><td class='odin-width-sm'><span class='odin-statusbar-time'>{{item.formatTime()}}</span></td><td class='odin-width-xs'><button type='button' class='close' ng-click='ctrl.removeAt($index)'><span class='btn-xs glyphicon glyphicon-remove'></span></button></td></tr></tbody></table></div><div class='odin-block odin-statusbar-clear'><button type='button' class='btn' ng-click='ctrl.clear()'>Clear All</button></div></div></div>"}})},r.prototype.getDefaultHeader=function(){var t=e.Framework.getApplication(this.rootScope);return t&&t.name?t.name:""},r.prototype.show=function(n){var i=this;n.type||(n.type=t.Information),n.header||(n.header=this.getDefaultHeader()),e.Log.debug("Show message "+n.header+" "+n.message+", type: "+n.type);var r=this.showDialog(n);return r.finally(function(){return i.raiseMessageAdded(n)}),r},r.prototype.configureButtons=function(e){e.primaryResult=i.Ok,e.buttons!=n.OkCancel&&e.buttons!=n.YesNoCancel||(e.showCancel=!0,e.secondaryResult=i.Cancel),e.buttons!=n.YesNo&&e.buttons!=n.YesNoCancel||(e.showSecondary=!0,e.primaryResult=i.Yes,e.secondaryResult=i.No)},r.prototype.showStatus=function(e,t){this.raiseMessageAdded({message:e,type:t})},r.prototype.showInfo=function(e,n){return this.show({message:e,header:n,type:t.Information})},r.prototype.showWarning=function(e,n){return this.show({message:e,header:n,type:t.Warning})},r.prototype.showError=function(e,n){return this.show({message:e,header:n,type:t.Error})},r.prototype.configure=function(e){this.options=e},r.prototype.messageAdded=function(){return this.messageEvent},r.prototype.raiseMessageAdded=function(t){e.Log.debug("Send message to statusbar "+t.header+" "+t.message+", type: "+t.type),this.messageEvent.raise(t)},r.prototype.showDialog=function(e){var t={};e.modalSettings?angular.extend(t,this.defaultSettings,e.modalSettings,e):angular.extend(t,this.defaultSettings,e);var r=this.languageService.tryGet(),o={},a=r.get("OK"),s=r.get("Cancel"),l=this.defaultOptions;l.cancelText=s,l.primaryText=a,angular.extend(o,l),e.buttons!=n.YesNo&&e.buttons!=n.YesNoCancel||(o.primaryText=r.get("Yes"),o.secondaryText=r.get("No")),angular.extend(o,e),this.configureButtons(o);var c=e.buttons!==n.YesNo;t.keyboard=c;var u=null;switch(e.buttons){case n.YesNo:u=o.secondaryResult;break;case n.OkCancel:case n.YesNoCancel:u=i.Cancel;break;case n.Ok:default:u=i.Ok}t.controller||(t.controller=["$scope","$uibModalInstance",function(e,t){e.options=o,e.options.primary=function(){t.close(o.primaryResult)},e.options.secondary=function(){t.close(o.secondaryResult)},e.options.cancel=function(){t.close(i.Cancel)},e.options.close=function(){t.close(u)}}]),t.backdrop="static";var d=this.q.defer();return this.modal.open(t).result.then(function(e){d.resolve(e)},function(e){c?d.resolve(o.buttons==n.Ok?i.Ok:i.Cancel):d.reject(e)}),d.promise},r.$inject=["$rootScope","$uibModal","$q","odinLanguageService"],r}();e.MessageService=l;var c=function(){function t(){}return t.prototype.init=function(e,t){this.scope=e,this.grid=t,this.addEvents()},t.prototype.addEvents=function(){var e=this;this.grid.$viewport.on("dblclick",function(){e.onDoubleClick()})},t.prototype.onDoubleClick=function(){e.Log.isDebug()&&e.Log.debug("[GridDoubleClickPlugin] double-click on row "+JSON.stringify(this.scope.selectedItems[0]));var t=this.scope["odin.DoubleClick"];t&&t.hasOwnProperty("onDoubleClick")&&t.onDoubleClick()},t}();e.GridDoubleClickPlugin=c;var u=function(){function t(){}return t.prototype.init=function(e,t){var n=this;this.scope=e,this.grid=t;var i=this;this.scope.$watch(function(){var e="";return angular.forEach(i.scope.columns,function(t){if(t.visible&&t.filterText){var n=(0==t.filterText.indexOf("*")?t.filterText.replace("*",""):"^"+t.filterText)+";";e+=t.displayName+": "+n}}),e},function(e){n.filterListner(e)})},t.prototype.filterListner=function(t){e.StringUtil.isNullOrEmpty(t)||(this.scope.$parent.filterText=t,this.grid.searchProvider.evalFilter())},t}();e.FilterGridPlugin=u}(Odin||(Odin={}));var Odin;!function(e){var t=function(){function e(){}return e.capitaliseFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.onKeyEvent=function(t,n,i,r,o){var a,s=[];a=i.$eval(o["odin"+e.capitaliseFirstLetter(n)]),angular.forEach(a,function(e,n){var i,r;r=t(e),angular.forEach(n.split(" "),function(e){i={expression:r,keys:{}},angular.forEach(e.split("-"),function(e){i.keys[e]=!0}),s.push(i)})}),r.bind(n,function(t){var r=!(!t.metaKey||t.ctrlKey),o=!!t.altKey,a=!!t.ctrlKey,l=!!t.shiftKey,c=t.keyCode;"keypress"===n&&!l&&c>=97&&c<=122&&(c-=32),angular.forEach(s,function(n){var s=n.keys[e.keysByCode[c]]||n.keys[c.toString()],u=!!n.keys.meta,d=!!n.keys.alt,p=!!n.keys.ctrl,h=!!n.keys.shift;s&&u===r&&d===o&&p===a&&h===l&&i.$apply(function(){n.expression(i,{$event:t})})})})},e.onKeyEventToUpper=function(e,t,n){var i=this;t.bind("keyup",function(e){i.forceUpper(e,t)})},e.doGetCaretPosition=function(e){var t=0,n=document.selection;if(n){e.focus();var i=n.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||0==e.selectionStart)&&(t=e.selectionStart);return t},e.doSetCaretPosition=function(e,t){var n=document.selection;if(n){e.focus();var i=n.createRange();i.moveStart("character",-e.value.length),i.moveStart("character",t),i.moveEnd("character",0),i.select()}else(e.selectionStart||0==e.selectionStart)&&(e.selectionStart=t,e.selectionEnd=t,e.focus())},e.forceUpper=function(e,t){if(9!==e.keyCode){var n=t[0],i=this.doGetCaretPosition(n);n.value=n.value.toUpperCase(),this.doSetCaretPosition(n,i)}},e.add=function(t){t.directive("odinKeydown",["$parse",function(t){return{link:function(n,i,r){e.onKeyEvent(t,"keydown",n,i,r)}}}]),t.directive("odinKeypress",["$parse",function(t){return{link:function(n,i,r){e.onKeyEvent(t,"keypress",n,i,r)}}}]),t.directive("odinKeyup",["$parse",function(t){return{link:function(n,i,r){e.onKeyEvent(t,"keyup",n,i,r)}}}]),t.directive("odinUppercase",[function(){return{link:function(t,n,i){e.onKeyEventToUpper(t,n,i)}}}])},e.keysByCode={8:"backspace",9:"tab",13:"enter",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},e}();e.KeyboardDirective=t;var n=function(){function e(){}return e.add=function(e){e.directive("odinRightClick",["$parse",function(e){return{link:function(t,n,i){var r=e(i.odinRightClick);n.bind("contextmenu",function(e){e.preventDefault(),r(t,{$event:e})})}}}])},e}();e.MouseDirective=n;var i=function(){function t(){}return t.add=function(t){var n=this;t.directive("odinNumber",function(){return{require:"?ngModel",link:function(t,i,r,o){if(o){var a,s,l,c,u,d=e.NumUtil.getDefaultOptions().separator,p={digits:"*",decimals:"0",maxValue:"*",separator:d,type:"number"},h=r.odinNumber,f=[];e.StringUtil.isNullOrEmpty(h)||(f=h.split(","),f.forEach(function(e,t){e||(f[t]="*")})),s=f[0]||r.odinDigits||p.digits,l=f[1]||r.odinDecimals||p.decimals,c=f[2]||r.odinMaxvalue||p.maxValue,u=r.odinSeparator||p.separator,a=r.odinType||p.type,a=a.toLowerCase();var g="number"===a,v="*"!=s?"{0,"+(parseInt(s)-1).toString()+"}":"*",m="";if("0"!=l){var y="*"!=u?u.replace(".","\\."):"[,\\.]",b="*"!=l?"{0,"+l+"}":"*";m="("+y+"\\d"+b+")"}var S=new RegExp("^[-]?([0-9])?\\d"+v+m+"?$");o.$formatters.push(function(t){return e.Util.hasValue(t)?e.NumUtil.format(t,{separator:u}):t}),o.$parsers.push(function(t){if(e.StringUtil.isNullOrEmpty(t))return g?0:"";if("number"==typeof t)return t;var r=S.test(t),a="*"!=c&&"-"!=t;if(t=t.replace(",","."),a&&r&&(r=parseFloat(t)<=parseInt(t)),r){if(g)try{if("number"!=typeof t){var s=t.replace(",",".");if(s.indexOf(".")>=0){var l=parseFloat(s);return l}var u=parseInt(s);return u}}catch(n){e.Log.debug("Failed to parse float or int "+t)}return t}var d=g?0:"",p=o.$modelValue||d,h=n.getCaretPosition(i)-1;if(""===p)o.$viewValue=p;else{var f=e.NumUtil.format(p);o.$setViewValue(f)}return o.$render(),angular.isUndefined(h)||n.setCaretPosition(i,h),p}),i.bind("keypress",function(e){32===e.keyCode&&e.preventDefault()})}}}})},t.getCaretPosition=function(e){var t=e[0],n=document.selection;if(n){var i=n.createRange();return i.moveStart("character",-e.val().length),i.text.length}return t.selectionStart},t.setCaretPosition=function(e,t){var n=e[0];if(n.createTextRange){var i=n.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}else n.setSelectionRange(t,t)},t}();e.NumberDirective=i}(Odin||(Odin={}));var Odin;!function(e){var t;!function(t){var n=function(){function e(e){this.scope=e}return e.prototype.sendEvent=function(e,t,n){var i={targetName:e,eventName:t,parameters:n};this.scope.odinMashupInstance.send(i)},e.$inject=["$scope"],e}();t.InstanceCtrl=n;var i=function(){function t(){this.receive=new e.InstanceEvent}return t.prototype.send=function(e){},t}();t.Instance=i;var r=function(){function e(){this.name="odinMashup"}return e.add=function(t){var n=new e;t.directive(n.name,function(){return n.create()})},e.prototype.create=function(){return{restrict:"E",replace:!0,scope:{id:"@",eventCallback:"&",src:"@"},controller:function(e){var t=new i;e.$parent.odinMashupInstance=t,t.send=function(t){var n={type:"OdinMashupEvent",data:t},i=document.getElementById(e.id).contentWindow;i.postMessage(n,"*")},e.receiveMessage=function(t){if("OdinMashupEvent"==t.data.type){var n=t.data.data.parameters,i={};n.forEach(function(e,t,n){i[e.targetKey]=e.value}),t.data.data.parameters=i,e.eventCallback({e:t.data.data})}else e.eventCallback({e:t.data})},window.addEventListener("message",e.receiveMessage,!1)},template:'<iframe id="" src=""></iframe>'}},e}();t.Directive=r;var o=function(){function t(){this.name="odinMashupControl"}return t.createIFrame=function(){return $("<iframe />").attr("sandbox","allow-same-origin allow-scripts allow-popups allow-forms").attr("seamless","seamless").attr("frameborder","0")},t.add=function(n){n.directive("odinMashupControl",["$rootScope",function(n){return{scope:!1,link:function(i,r,o,a,s){var l=function(){var e=i.$eval(o.options),n=e.getOptions();if(n&&n.url){var a=t.createIFrame();a.attr("src",n.url);var s=o.iframeClass;s?a.addClass(s):a.css({position:"absolute",width:"100%",height:"100%",left:0,top:0,right:0,bottom:0});var l=a[0];l.onload=function(){e.onFrame(l)},r.append(a)}},c=n.$watch(e.StartupState.ready,function(e){e&&(c(),l())})}}}])},t}();t.ControlDirective=o,function(e){e[e.Pending=0]="Pending",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Running=3]="Running",e[e.Busy=4]="Busy",e[e.Failed=5]="Failed"}(t.ControlStatus||(t.ControlStatus={}));var a=t.ControlStatus,s=function(){function e(e){var t=this;this.registeredEvents=[],this.isInitialized=!1,this.status=a.Pending,window.addEventListener("message",function(e){return t.receiveMessage(e)},!1)}return e.prototype.getOptions=function(){var e=this;return{onFrame:function(t){return e.onFrame(t)},getOptions:function(){var t=e.onGetOptions();return e.controlOptions=t,e.controlId=t.webControl.id,t}}},e.prototype.onFrame=function(e){if(this.iframe=e,this.controlOptions){var t=this.controlOptions.webControl;t.url||(t.url=this.controlOptions.url);var n={type:"MashupInitialize",data:{webControl:t}};this.postMessage(n)}},e.prototype.onGetOptions=function(){return null},e.prototype.registerEvents=function(e){
var t=this;e.forEach(function(e,n,i){t.registeredEvents.push(e)})},e.prototype.onInitialized=function(){},e.prototype.postMessage=function(e){this.iframe.contentWindow.postMessage(e,"*")},e.prototype.raiseEvent=function(e){if(this.status==a.Initialized||this.status==a.Running){var t={type:"MashupLoad",data:e};return this.iframe.contentWindow.postMessage(t,"*"),!0}return!1},e.prototype.raiseGetValuesEvent=function(e){var t={type:"MashupGetValues",data:{parameters:e.parameters,sourceName:this.controlId,sourceEventName:e.sourceEventName,targetName:"MashupFramework"}};this.postMessage(t)},e.prototype.getEventInfo=function(e){for(var t=this.registeredEvents,n=0;n<t.length;n++){var i=t[n];if(i.sourceEventName===e)return i}return null},e.prototype.receiveMessage=function(e){var t,n=JSON.parse(e.data);if(n.id==this.controlId)if("MashupSetStatus"==n.type){var i=n.data;this.status=i,a.Initialized==i&&(this.isInitialized=!0,this.onInitialized())}else if("MashupEvent"==n.type)t=this.getEventInfo(n.data),null!=t&&this.raiseGetValuesEvent(t);else if("MashupEventValues"==n.type){var r=n.data;t=this.getEventInfo(r.sourceEventName),t&&t.onEvent&&t.onEvent(r)}},e.$inject=["$scope"],e}();t.ControlCtrl=s}(t=e.Mashup||(e.Mashup={}))}(Odin||(Odin={}));var Odin;!function(e){var t=function(){function t(e,t,n){this.rootScope=e,this.applicationService=t,this.messageService=n,this.logPrefix="[Odin.StartupState] ",this.isReady=!1,this.error=null}return t.prototype.setReady=function(){this.isReady,this.isReady=!0,this.rootScope[t.ready]=!0,this.applicationService.setActive(),e.Log.info(this.logPrefix+"Ready")},t.prototype.setError=function(e){this.applicationService.setState(s.Error),this.error=e},t.prototype.getError=function(){return this.error},t.prototype.hasError=function(){return!!this.error},t.prototype.showErrorMessage=function(t,n){var i=this.error;i||(i={}),t&&(i.header=t),n&&(i.message=n),i.type=e.MessageType.Error,this.messageService.show(i)},t.ready="odinReady",t}();e.StartupState=t;var n=function(){function t(t,n){this.q=t,this.http=n,this.logPrefix="[LanguageService] ",this.pending=[],this.isReady=!1,this.language=new e.Language,angular.extend(this.language,{OK:"OK",Cancel:"Cancel",Yes:"Yes",No:"No"})}return t.add=function(e){e.service("odinLanguageService",t)},t.prototype.tryGet=function(){return this.language},t.prototype.get=function(){var e=this.q.defer();return this.isReady?e.resolve(this.language):this.pending.push(e),e.promise},t.prototype.getUrl=function(t,n){return e.Framework.getPath()+"/localization/"+t+"/"+n},t.prototype.resolve=function(e){this.isReady=!0,e.resolve(this.language);for(var t=0;t<this.pending.length;t++)this.pending[t].resolve(this.language)},t.prototype.reject=function(t,n,i){var r="Failed to load language. Status: "+i.status+" URL: "+n;e.Log.error(r);var o=new e.Language;o.errorMessage=r,t.reject(o);for(var a=0;a<this.pending.length;a++)this.pending[a].reject(o)},t.prototype.loadFiles=function(t,n){var i=this,r=n[0];n=n.slice(1),e.Log.debug(this.logPrefix+"Loading file "+r),this.http.get(r).then(function(e){var r=e.data;angular.extend(i.language,r),n.length>0?i.loadFiles(t,n):i.resolve(t)},function(e){i.reject(t,r,e)})},t.prototype.load=function(e){var t=this.q.defer();e.standard!==!1&&(e.standard=!0);var n=e.language;n||(n="en-US");var i,r=[];if(e.application){var o=e.applicationFilename;o||(o="application.js"),i=this.getUrl(n,o),r.push(i)}return e.standard&&(i=this.getUrl(n,"standard.js"),r.push(i)),r.length>0?this.loadFiles(t,r):this.resolve(t),t.promise},t.$inject=["$q","$http"],t}(),i=function(){function t(){this.logPrefix="[StorageService] ",this.keyPrefix="odin-",this.nameSessionStorage="sessionStorage",this.nameLocalStorage="localStorage",this.nameApplicationStorage="applicationStorage",this.applicationStorage={}}return t.prototype.getKey=function(e){if(!e)throw"Missing key";return this.keyPrefix+e},t.prototype.getLocal=function(e,t){return this.getValueFromStorage(e,localStorage,this.nameLocalStorage,t)},t.prototype.setLocal=function(e,t){this.setValueInStorage(e,t,localStorage,this.nameLocalStorage)},t.prototype.getSession=function(e,t){return this.getValueFromStorage(e,sessionStorage,this.nameSessionStorage,t)},t.prototype.setSession=function(e,t){this.setValueInStorage(e,t,sessionStorage,this.nameSessionStorage)},t.prototype.setValueInStorage=function(t,n,i,r){var o=this.getKey(t);if(i)try{r===this.nameApplicationStorage?i[o]=n:r===this.nameSessionStorage?i[o]=JSON.stringify(n):r===this.nameLocalStorage&&i.setItem(o,JSON.stringify(n)),e.Log.debug(this.logPrefix+"Saved value: "+n+" in "+r)}catch(t){e.Log.warning(this.logPrefix+"Failed to store "+n+" in "+r)}else e.Log.warning(this.logPrefix+"No "+r+" available")},t.prototype.getValueFromStorage=function(t,n,i,r){var o=this.getKey(t),a=null;if(n)try{return a=i==this.nameLocalStorage?n.getItem(o):n[o],a?(e.Log.debug(this.logPrefix+"Key: "+t+" found in "+i+", value: "+a),i===this.nameApplicationStorage?a:JSON.parse(a)):(e.Log.debug(this.logPrefix+"Key: "+t+" does not exist in "+i),null!=r?r:null)}catch(n){e.Log.warning(this.logPrefix+"Failed to get key: "+t+", value:"+a+" in "+i)}else e.Log.warning(this.logPrefix+"No "+i+" available");return null},t.prototype.getApplication=function(e,t){return this.getValueFromStorage(e,this.applicationStorage,this.nameApplicationStorage,t)},t.prototype.setApplication=function(e,t){this.setValueInStorage(e,t,this.applicationStorage,this.nameApplicationStorage)},t.prototype.clearLocalStorage=function(){var t=this,n=this.keyPrefix.length;Object.keys(localStorage).forEach(function(e){e.substring(0,n)==t.keyPrefix&&localStorage.removeItem(e)}),e.Log.debug(this.logPrefix+"Removed all odin- items from Local Storage")},t.prototype.clearApplicationStorage=function(){this.applicationStorage={},e.Log.debug(this.logPrefix+"Cleared Application Storage")},t.prototype.clearSessionStorage=function(){var t=this,n=this.keyPrefix.length;Object.keys(sessionStorage).forEach(function(e){t.keyPrefix;e.substring(0,n)==t.keyPrefix&&sessionStorage.removeItem(e)}),e.Log.debug(this.logPrefix+"Removed all odin- items from  Session Storage")},t.prototype.deleteKeyLocalStorage=function(t){localStorage.removeItem(this.getKey(t)),e.Log.debug(this.logPrefix+"Removed key: "+t+"from Local Storage")},t.prototype.deleteKeyApplicationStorage=function(t){delete this.applicationStorage[this.getKey(t)],e.Log.debug(this.logPrefix+"Removed key: "+t+"from Application Storage")},t.prototype.deleteKeySessionStorage=function(t){sessionStorage.removeItem(this.getKey(t)),e.Log.debug(this.logPrefix+"Removed key: "+t+"from Session Storage")},t.add=function(e){e.service("odinStorageService",t)},t}(),r=function(){function e(){}return e.browseGridTemplateName="odin/partials/gridBrowse.html",e.browseGenericTemplateName="odin/partials/genericBrowse.html",e.modalMessageTemplate="odin/partials/modalMessage.html",e}();e.BrowseConstants=r;var o=function(){function t(e,t){this.modal=e,this.q=t}return t.add=function(e){e.service("odinBrowseService",t)},t.prototype.browse=function(t){var n=t.templateUrl?e.BrowseConstants.browseGenericTemplateName:e.BrowseConstants.browseGridTemplateName,i=angular.copy(t),r=this.modal.open({templateUrl:n,controller:m,backdrop:"static",resolve:{browseOptions:function(){return i}}}).result;return r},t.$inject=["$uibModal","$q"],t}();e.BrowseService=o;var a=function(){function t(){}return t.setSelectedItem=function(e,t){this.setSelectedItemInternal(e,t)},t.close=function(n,i){var r=n[t.selectedItemKeyInternal];r&&r.hasOwnProperty("close")?r.close(i):e.Log.debug("Can not find odinBrowseResult")},t.setSelectedItemInternal=function(e,n){if(e){var i=e[t.selectedItemKeyInternal];if(i&&i.hasOwnProperty("selectedItem"))i.selectedItem=n;else{var r=e.$parent;r&&this.setSelectedItemInternal(r,n)}}},t.selectedItemKeyInternal="odinBrowseResult",t}();e.BrowseUtil=a,function(e){e[e.Pending=0]="Pending",e[e.Active=1]="Active",e[e.Busy=2]="Busy",e[e.Error=3]="Error"}(e.ApplicationState||(e.ApplicationState={}));var s=e.ApplicationState,l=function(){function t(n,i){var r=this;this.componentService=n,this.nameOdinBusy="odinBusy",this.busy=!1,this.busyEvent=new e.InstanceEvent,this.activeEvent=new e.InstanceEvent,this.stateEvent=new e.InstanceEvent,this.visibleEvent=new e.InstanceEvent,this.id=0,this.scope=i.scope,this._isVisible=!0,this.state=e.ComponentState.Active,this.id=t.counter++;var o=i.visualState;o?(this.isVisualState=!0,o.activeChanged().on(function(e){r.setVisible(e)})):(this.isVisualState=i.isVisualState,this.isVisualState&&i.scope.$parent.$watch("odinVisualState.isActive",function(t){e.Util.isUndefined(t)||r.setVisible(t)}))}return t.prototype.raise=function(e){this.componentService.raise(e)},t.prototype.raiseEvent=function(e,t){this.componentService.raiseEvent(e,t)},t.prototype.getPendingEvent=function(){return this.pendingEvent},t.prototype.setPendingEvent=function(e){this.pendingEvent=e},t.prototype.stateChanged=function(){return this.stateEvent},t.prototype.setActiveState=function(t){this.setState(e.ComponentState.Active,t)},t.prototype.setBusyState=function(t){this.setState(e.ComponentState.Busy,t)},t.prototype.getContext=function(e){return this.componentService.getContext(e)},t.prototype.setState=function(t,n){if(n){var i=this.getContext(n);return void(i&&i.setState(t))}if(this.state!=t){var r=this.isActive();this.state=t,this.scope[this.nameOdinBusy]=t==e.ComponentState.Busy,this.stateEvent.raise(this.state),this.raiseActive(r)}},t.prototype.getState=function(e){if(e){var t=this.getContext(e);return t?t.getState():null}return this.state},t.prototype.isBusy=function(t){return this.getState(t)===e.ComponentState.Busy},t.prototype.activeChanged=function(){return this.activeEvent},t.prototype.isActive=function(t){var n=t?this.getContext(t):this;return n?n.state===e.ComponentState.Active&&n._isVisible:null},t.prototype.visibleChanged=function(){return this.visibleEvent},t.prototype.isVisible=function(e){var t=e?this.getContext(e):this;return t?t._isVisible:null},t.prototype.setVisible=function(e,t){if(t){var n=this.getContext(t);return void(n&&n.setVisible(e))}if(this._isVisible!=e){var i=this.isActive();this._isVisible=e,this.visibleEvent.raise(e),this.raiseActive(i)}},t.prototype.raiseActive=function(e){var t=this.isActive();e!==t&&this.activeEvent.raise(t)},t.counter=0,t}(),c=function(){function e(e){this.rootScope=e,this.logPrefix="[ApplicationService] ",this.nameBusy="odinApplicationBusy",this.state=s.Pending}return e.add=function(t){t.service("odinApplicationService",e)},e.prototype.setState=function(e){this.state!=e&&(this.state=e,this.rootScope[this.nameBusy]=e==s.Busy)},e.prototype.getState=function(){return this.state},e.prototype.setActive=function(){this.setState(s.Active)},e.prototype.isActive=function(){return this.state==s.Active},e.prototype.setBusy=function(){this.setState(s.Busy)},e.prototype.isBusy=function(){return this.state==s.Busy},e.$inject=["$rootScope"],e}(),u=function(){function t(e){this.rootScope=e,this.logPrefix="[ComponentService] ",this.events={},this.namedComponents={}}return t.add=function(e){e.service("odinComponentService",t)},t.prototype.getContext=function(e){return this.namedComponents[e]},t.prototype.setComponentState=function(e,t){var n=this.namedComponents[t];n&&n.setState(e)},t.prototype.raise=function(t){e.Log.debug(this.logPrefix+"Raising event "+t.eventName),this.rootScope.$broadcast(t.eventName,t)},t.prototype.raiseEvent=function(e,t){this.raise({eventName:e,parameter:t})},t.prototype.canDeliver=function(e){return e.alwaysReceive||e.context.isActive()},t.prototype.deliverPending=function(e){var t=e.getPendingEvent();t&&e.isActive()&&(this.deliverEvent(t.eventInfo,t),e.setPendingEvent(null))},t.prototype.register=function(e){var t=this,n=e;n.isVisualState!==!1&&(n.isVisualState=!0);var i=new l(this,e),r=e.name;if(r){if(this.namedComponents[r])throw"The component "+r+" has already been registered.";this.namedComponents[r]=i}if(e.events){for(var o=0;o<e.events.length;o++){var a=e.events[o];if(!a.eventName)throw"Property eventName not set";if(!a.onEvent)throw"Property onEvent not set";this.subscribeEvent(e,i,a)}i.activeChanged().on(function(e){e&&t.deliverPending(i)})}return i},t.prototype.subscribeEvent=function(e,t,n){var i=this;n.context=t,n.isVisualState=e.isVisualState;var r=n.eventName,o=this.events[r];o||(o=[],this.events[r]=o,this.rootScope.$on(r,function(e,t){i.onEvent(e,t)})),o.push(n)},t.prototype.onEvent=function(t,n){var i=n.eventName;if(e.StringUtil.isNullOrEmpty(i)){var r={eventName:i,parameter:n};n=r}var o=this.events[i];if(o)for(var a=0;a<o.length;a++){var s=o[a];if(this.canDeliver(s))this.deliverEvent(s,n);else{var l=angular.copy(n);l.eventInfo=s,s.context.setPendingEvent(l),e.Log.debug(this.logPrefix+"Delayed delivery of event "+l.eventName)}}},t.prototype.deliverEvent=function(t,n){if(t.onEvent)try{e.Log.debug(this.logPrefix+"Delivering event "+n.eventName),t.onEvent(n)}catch(t){e.Log.error(this.logPrefix+"Failed to deliver event "+n.eventName,t)}},t.prototype.setBusyIndicator=function(e,t){e.odinBusy=t},t.$inject=["$rootScope"],t}(),d=function(){function t(n){this.scope=n,this.isActive=!1,this.isActivated=!1,this.children=[],this.id=0,this.activeEvent=new e.InstanceEvent,this.updateScope(),this.attachToParent(n.$parent),this.id=t.counter++}return t.prototype.activeChanged=function(){return this.activeEvent},t.prototype.updateScope=function(){this.scope[t.scopeName]=null,this.scope[t.scopeName]=this},t.prototype.addChild=function(e){this.children.push(e)},t.prototype.isActiveInScope=function(e){if(e){var n=e[t.scopeName];return!(n&&!n.isActive)&&this.isActiveInScope(e.$parent)}return!0},t.prototype.attachToParent=function(e){if(e){var n=e[t.scopeName];if(n)return void n.addChild(this);this.attachToParent(e.$parent)}},t.prototype.activate=function(){if(this.isActivated=!0,this.isActiveInScope(this.scope.$parent)){this.isActive=!0;for(var e=0;e<this.children.length;e++)this.children[e].activateChild()}this.updateScope(),this.activeEvent.raise(!0)},t.prototype.deactivate=function(){this.isActivated=!1,this.isActive=!1;for(var e=0;e<this.children.length;e++)this.children[e].deactivateChild();this.updateScope(),this.activeEvent.raise(!1)},t.prototype.activateChild=function(){this.isActivated&&(this.isActive=!0)},t.prototype.deactivateChild=function(){this.isActive&&(this.isActive=!1)},t.scopeName="odinVisualState",t.counter=0,t}();e.VisualState=d;var p=function(){function e(e){this.scope=e,this.visualState=new d(e)}return e.add=function(t){t.controller("OdinVisualStateCtrl",e)},e.prototype.activate=function(){this.visualState.activate()},e.prototype.deactivate=function(){this.visualState.deactivate()},e.$inject=["$scope"],e}();e.VisualStateCtrl=p;var h=function(){function e(e){this.scope=e}return e.add=function(t){t.controller("OdinTabCtrl",e)},e.prototype.select=function(){this.visualState.activate()},e.prototype.deselect=function(){this.visualState.deactivate()},e.$inject=["$scope"],e}();e.TabCtrl=h;var f=function(){function e(){}return e.add=function(e){e.directive("odinNavbar",function(){return{restrict:"E",replace:!0,transclude:!0,scope:{header:"@",theme:"@"},template:"<nav class='navbar navbar-default navbar-static-top' role='navigation'><div class='navbar-header'><button type='button' class='navbar-toggle' ng-init='navbarCollapsed=true' ng-click='navbarCollapsed=!navbarCollapsed'><span class='sr-only'>Toggle navigation</span><span class='icon-bar'></span><span class='icon-bar'></span><span class='icon-bar'></span></button><a class='navbar-brand' href='#/'>{{header}}</a></div><div class='collapse navbar-collapse' ng-class='!navbarCollapsed && \"in\"'><ul class='nav navbar-nav navbar-right' ng-show='{{theme}}'><li class='dropdown' uib-dropdown><a href='#' class='dropdown-toggle' uib-dropdown-toggle>Theme <span class='caret'></span></a><ul class='dropdown-menu' uib-dropdown-menu role='menu'>"+'<li><a href=\'javascript:void(0);\' onclick=\'var element=document.querySelector("#odin-theme");element.setAttribute("href", element.getAttribute("href").replace("bootstrap", "default"));var xi=document.querySelector("#xi-theme");xi.disabled=true;\'>Odin</a></li><li><a href=\'javascript:void(0);\' onclick=\'var element=document.querySelector("#odin-theme");element.setAttribute("href", element.getAttribute("href").replace("default", "bootstrap"));var xi=document.querySelector("#xi-theme");xi.disabled=true;\'>Bootstrap</a></li><li><a href=\'javascript:void(0);\' onclick=\'var element=document.querySelector("#odin-theme");element.setAttribute("href", element.getAttribute("href").replace("bootstrap", "default"));var xi=document.querySelector("#xi-theme");xi.disabled=false;\'>Xi</a></li></ul></li></ul><div ng-transclude></div></div></nav>'}})},e}();e.NavbarDirective=f;var g=function(){function e(){this.scopeNameGridOptions="gridOptions",this.scopeNameGridData="items",this.configureGrid=!0}return e.get=function(t){var n=new e;return t?(angular.extend(n,t),n):n},e}();e.DefaultListCtrlOptions=g;var v=function(){function n(e,n,i){var r=this;void 0===i&&(i=null),this.baseCtrlOptions=i,this.prefixBaseCtrl="[Odin.BaseCtrl] ",this.baseScope=e,this.odinService=n,this.rootScope=n.rootScope,this.componentService=n.componentService;var o=this.rootScope.$watch(t.ready,function(e){e&&(o(),r.ctrlInit())})}return n.prototype.ctrlInit=function(){if(this.isInitialized)throw"Already initialized";this.isInitialized=!0,e.Log.debug(this.prefixBaseCtrl+"Initialize"),this.onReady()},n.prototype.registerComponent=function(e){var t=this;if(void 0===e&&(e={}),this.componentContext)throw"A component context has already been registered";e.scope||(e.scope=this.baseScope);var n=this.componentService.register(e);return n.activeChanged().on(function(e){return t.onActive(e)}),this.componentContext=n,this.componentContext},n.prototype.getComponentContext=function(){return this.componentContext||this.registerComponent(),this.componentContext},n.prototype.onActive=function(e){},n.prototype.setBusy=function(){this.getComponentContext().setBusyState()},n.prototype.isBusy=function(){return this.getComponentContext().isBusy()},n.prototype.setActive=function(){this.getComponentContext().setActiveState()},n.prototype.onReady=function(){},n}();e.BaseCtrl=v;var m=function(t){function n(n,i,r,o){var s=this;if(t.call(this,n,r),this.scope=n,this.modalInstance=i,this.service=r,this.browseOptions=o,!o)return void e.Log.error("Missing mandatory browseOptions");var l=r.languageService.tryGet();if(n.lang=l,o.gridOptions){var c=this.browseOptions.gridOptions;this.browseOptions.items?c.data=this.browseOptions.items:c.data||(c.data="items"),c.onRegisterApi||(c.onRegisterApi=function(e){s.gridApi=e,e.selection.on.rowSelectionChanged(n,function(e){s.afterSelectionChange(e)})});var u={onDoubleClick:function(){s.closeWithSelected()}};this.scope["odin.DoubleClick"]=u,n.gridOptions=o.gridOptions}n.options={gridOptions:o.gridOptions,header:o.header,message:o.message,templateUrl:o.templateUrl},o.items&&(n.items=o.items),n.ok=function(){s.closeWithSelected()},n.cancel=function(){e.Log.debug("Cancel in dialog. Returning null "),s.modalInstance.close(null)},n.close=function(t){e.Log.debug("Close called on scope. Returning item "+t),s.modalInstance.close(t)};var d={selectedItem:null,close:function(e){s.modalInstance.close(e)}};n[a.selectedItemKeyInternal]=d}return __extends(n,t),n.prototype.closeWithSelected=function(){var t=this.scope.odinBrowseResult?this.scope.odinBrowseResult.selectedItem:null;e.Log.debug("Selected item on scope is "+t),this.modalInstance.close(t)},n.prototype.onReady=function(){},n.prototype.afterSelectionChange=function(e){return e.isSelected?void a.setSelectedItem(this.scope,e.entity):void a.setSelectedItem(this.scope,null)},n.add=function(e){e.controller("OdinDefaultBrowseCtrl",n)},n.$inject=["$scope","$uibModalInstance","odinService","browseOptions"],n}(v);e.DefaultBrowseCtrl=m;var y=function(){function t(){this.name="odinExpander",this.scopeName="isExpanded"}return t.add=function(e){var n=new t;e.directive(n.name,["$compile",function(e){return n.create(e)}])},t.prototype.create=function(t){var n=this;return{restrict:"E",transclude:!0,compile:function(t,i){return i[n.scopeName]||(i[n.scopeName]=e.Util.getUuid("expander")),null},scope:{header:"@",isExpanded:"="},template:"<fieldset class='odin-expander'><legend ng-click='isExpanded = !isExpanded'><span>{{header}}</span></legend><button type='button' class='odin-expander-button' role='button' ng-class='{\"true\": \"open\", \"false\": \"closed\", undefined: \"closed\"}[isExpanded]' ng-click='isExpanded = !isExpanded'></button><div class='content' uib-collapse='!isExpanded' ng-transclude></div></fieldset>"}},t}();e.ExpanderDirective=y;var b=function(){function e(){}return e.add=function(e){e.directive("odinFormElement",function(){return{restrict:"E",replace:!0,transclude:!0,compile:function(e,t){var n=$("<div />").addClass("form-group");e.append(n);var i=12;if(t.label){t.labelSize||(t.labelSize=3),i-=t.labelSize;var r=$("<label />").addClass("control-label col-md-"+t.labelSize).text(t.label).append($("<span />"));t.forId&&r.attr("for",t.forId),t.labelTooltip&&r.attr("title",t.labelTooltip),n.append(r)}var o=$("<div />").attr("ng-transclude","");return t.elementOffset&&(o.addClass("col-md-offset-"+t.elementOffset),i-=t.elementOffset),n.append(o),t.additional&&(t.additionalSize||(t.additionalSize=3),i-=t.additionalSize,n.append($("<label />").addClass("odin-additional-label control-label col-md-"+t.additionalSize).text(t.additional).append($("<span />")).attr("title",t.additional))),o.addClass("col-md-"+i),null},template:"<div></div>"}})},e}();e.FormElementDirective=b;var S=function(){function t(){}return t.add=function(t){t.directive("odinCheckbox",function(){return{restrict:"E",replace:!0,transclude:!1,compile:function(t,n){n.checkboxId||(n.checkboxId=e.Util.getUuid("checkbox"));var i=$("<label />");t.append(i);var r=$("<input />").attr({type:"checkbox","ng-checked":"value","ng-click":"value = !value",id:n.checkboxId});n.name&&r.attr("name",n.name),i.append(r),n.isDisabled&&("true"==n.isDisabled?r.attr("disabled",""):"false"!=n.isDisabled&&r.attr("ng-disabled","isDisabled"));var o=$("<span />").attr("for",n.checkboxId);return i.append(o),n.label&&o.html("{{label}}"),null},scope:{checkboxId:"@",value:"=",label:"@",isDisabled:"=",name:"@"},template:'<div class="checkbox"></div>'}})},t}();e.CheckboxDirective=S;var C=function(){function t(){}return t.add=function(t){t.directive("odinRadio",function(){return{restrict:"E",replace:!0,transclude:!1,compile:function(t,n){n.radioId||(n.radioId=e.Util.getUuid("radio"));var i=$("<label />");t.append(i);var r=$("<input />").attr({type:"radio","ng-checked":"model == value","ng-click":"model = value",id:n.radioId,value:"value"});n.name&&r.attr("name",n.name),i.append(r),n.isDisabled&&("true"==n.isDisabled?r.attr("disabled",""):"false"!=n.isDisabled&&r.attr("ng-disabled","isDisabled"));var o=$("<span />").attr("for",n.radioId);return i.append(o),n.label&&o.html("{{label}}"),null},scope:{radioId:"@",value:"@",label:"@",model:"=",isDisabled:"=",name:"@"},template:'<div class="radio"></div>'}})},t}();e.RadioDirective=C;var x=function(){function t(){}return t.add=function(t){t.directive("odinSwitch",function(){return{restrict:"E",replace:!0,transclude:!1,compile:function(t,n){n.switchId||(n.switchId=e.Util.getUuid("switch"));var i=$("<input />").attr({type:"checkbox",id:n.switchId,value:"value","ng-checked":"value","ng-click":"value = !value"});n.name&&i.attr("name",n.name),n.isDisabled&&("true"==n.isDisabled?i.attr("disabled",""):"false"!=n.isDisabled&&i.attr("ng-disabled","isDisabled")),t.append(i);var r=$("<label />").attr("for",n.switchId);t.append(r);var o=$("<span />").addClass("switch-box");return o.append($("<span />").addClass("switch-inner")),o.append($("<span />").addClass("switch-switch")),r.append(o),r.append($("<span />").addClass("switch-label").html("{{label}}")),null},scope:{switchId:"@",value:"=",label:"@",isDisabled:"@",name:"@"},template:'<div class="switch"></div>'}})},t}();e.SwitchDirective=x;var I=function(){function t(){}return t.add=function(t){t.directive("odinInput",function(){return{restrict:"E",replace:!0,transclude:!1,compile:function(t,n){n.inputId||(n.inputId=e.Util.getUuid("input"));var i=$("<div />").addClass("form-group");t.append(i);var r=12;if(n.label){n.labelSize||(n.labelSize=3),r-=n.labelSize;var o=$("<label />").addClass("control-label col-md-"+n.labelSize).text(n.label).attr("for",n.inputId).append($("<span />"));n.labelTooltip&&o.attr("title",n.labelTooltip),i.append(o)}var a=$("<div />");n.inputOffset&&(a.addClass("col-md-offset-"+n.inputOffset),r-=n.inputOffset),i.append(a),n.value||(n.value=e.Util.getUuid("input"));var s=$("<input />").attr({"ng-model":n.value,id:n.inputId,type:"text"}).addClass("form-control");return n.size&&s.addClass("odin-input-"+n.size),n.placeholder&&s.attr("placeholder",n.placeholder),n.isReadonly&&"true"==n.isReadonly&&s.attr("readonly",""),n.isDisabled&&("true"==n.isDisabled?s.attr("disabled",""):"false"!=n.isDisabled&&s.attr("ng-disabled","isDisabled")),n.required&&s.attr("ng-required",n.required),n.autofocus&&"true"==n.autofocus&&s.attr("odin-focus-auto",""),a.append(s),n.additional&&(n.additionalSize||(n.additionalSize=3),r-=n.additionalSize,i.append($("<label />").addClass("odin-additional-label control-label col-md-"+n.additionalSize).attr("title",n.additional).text(n.additional).append($("<span />")))),a.addClass("col-md-"+r),null},template:"<div class='col-md-12'></div>"}})},t}();e.InputDirective=I;var w=function(){function e(){}return e.add=function(e){e.directive("odinExpandableFooter",function(){return{restrict:"E",replace:!0,template:"<div><div ng-if='odinExpandableFooter.useOverlay' ng-class='{\"true\": \"odin-position-f-fill\"}[odinExpandableFooter.isExpanded && odinExpandableFooter.useOverlay]' class='odin-expandable-footer-overlay' ng-show='odinExpandableFooter.isExpanded' ng-click='odinExpandableFooter.isExpanded=false'></div><div class='odin-expandable-footer navbar-fixed-bottom'><div class='container-fluid'><div class='row'><div class='col-xs-12 odin-expandable-footer-header odin-cursor-pointer' ng-click='odinExpandableFooter.isExpanded = !odinExpandableFooter.isExpanded'><div class='odin-padding-md-r' ng-include='odinExpandableFooter.headerTemplateUrl'></div><span class='glyphicon' ng-class='{\"false\": \"glyphicon-chevron-up\", \"true\": \"glyphicon-chevron-down\", \"undefined\": \"glyphicon-chevron-up\"}[odinExpandableFooter.isExpanded]'></span></div></div><div class='row odin-expandable-footer-content' uib-collapse='!odinExpandableFooter.isExpanded'><div class='col-xs-12' ng-include='odinExpandableFooter.contentTemplateUrl'></div></div></div></div></div>"}})},e}();e.ExpandableFooterDirective=w;var E=function(){function e(){}return e.add=function(e){e.directive("odinSplashScreen",function(){return{restrict:"E",replace:!0,transclude:!1,scope:{value:"@",description:"@"},template:'<div class="odin-splash-screen"><div class="odin-splash-screen-container"><div class="odin-splash-screen-logo"></div><h1>{{value}}<br></h1><p>{{description}}</p><br><span class="odin-busy-indicator-large"></span></div></div>'}})},e}();e.SplashScreenDirective=E;var O=function(){function e(){}return e.add=function(e){e.directive("odinBusyIndicator",function(){return{restrict:"E",replace:!0,transclude:!1,template:'<div class="odin-busy-indicator-parent"><div class="odin-busy-indicator-text"></div></div>'}})},e}();e.BusyIndicatorDirective=O;var M=function(){function e(){}return e.add=function(e){e.directive("odinCircularTile",function(){return{restrict:"E",replace:!0,transclude:!1,compile:function(e,t){return t.size||(t.size="col-md-3 col-sm-4"),null},scope:{itemId:"@",name:"@",description:"@",imageUrl:"@",buttonText:"@",onClickButton:"&",model:"=",size:"@"},template:"<div class='{{size}} odin-circular-tile'><a href='javascript:void(0)' ng-click='model=itemId'><div ng-if='!imageUrl' class='odin-tile-circle'><h2>{{itemId}}</h2></div><div ng-if='imageUrl' class='odin-tile-circle image' style='background-image: url(\"{{imageUrl}}\");'></div><h3>{{name}}</h3></a><div class='odin-tile-details row' ng-class='{\"visible\": model===itemId, \"hidden\": model !==itemId}'><button type='button' class='close' ng-click='model=null'>×</button><div class='col-sm-12 odin-tile-content'><div class='row'><div class='col-sm-12'><div ng-if='!imageUrl' class='odin-tile-circle'><h2>{{itemId}}</h2></div><div ng-if='imageUrl' class='odin-tile-circle image' style='background-image: url(\"{{imageUrl}}\");'></div><h2>{{name}}</h2><p class='odin-tile-productId'>{{itemId}}</p><p ng-if='description' class='odin-tile-description'>{{description}}</p><a ng-if='buttonText' class='btn btn-default' ng-click='onClickButton()'>{{buttonText}}</a></div></div></div></div></div>"}})},e}();e.CircularTileDirective=M;var L=function(){function n(e,t,n,i){this.rootScope=e,this.q=t,this.location=n,this.service=i,this.logPrefix="[Odin.StartupService] ",this._isReady=!1}return n.add=function(e){e.service("odinStartupService",n)},n.prototype.isLocalhost=function(){return"localhost"==this.location.host()},n.prototype.getUrlOverride=function(e){var t=this.options;if(t&&t.urlOverrides){var n=t.urlOverrides[e];if(n){var i=this.location.host();if(i===n.host&&n.url)return n.url}}return null},n.prototype.isReady=function(){return this._isReady},n.prototype.raiseReady=function(){return"Ready state already set"},n.prototype.setReady=function(){if(this.isReady())throw this.raiseReady();this._isReady=!0;var e=new t(this.rootScope,this.service.applicationService,this.service.messageService);e.setReady()},n.prototype.resolveReady=function(e){var n=new t(this.rootScope,this.service.applicationService,this.service.messageService);e.resolve(n)},n.prototype.rejectReady=function(n,i){var r=i.errorMessage;e.Log.error(this.logPrefix+"Startup failed: "+r);var o=new t(this.rootScope,this.service.applicationService,this.service.messageService);o.setError({message:r,type:e.MessageType.Error}),n.reject(o)},n.prototype.initialize=function(t){this.options=t,t.application&&e.Framework.setApplication(this.rootScope,t.application),t.frameworkPath&&e.Framework.setPath(t.frameworkPath)},n.prototype.start=function(t){var n=this;if(this.isReady())throw this.raiseReady();var i=this.q.defer();t&&this.initialize(t),this.options||(this.options={});var r=this.options.languageOptions;if(r){var o=!e.StringUtil.isNullOrEmpty(r.language),a=!e.StringUtil.isNullOrEmpty(r.defaultLanguage),s=r.supportedLanguages&&r.supportedLanguages.length>0,l=e.ArrayUtil.contains(r.supportedLanguages,r.language);(o&&s&&!l||!o&&a)&&(r.language=r.defaultLanguage),this.service.languageService.load(r).then(function(){n.resolveReady(i)},function(e){n.rejectReady(i,e)})}else this.resolveReady(i);return i.promise},n.$inject=["$rootScope","$q","$location","odinService"],n}();e.StartupService=L;var D=function(){function e(){}return e.add=function(e){e.filter("odinDate",["$filter","odinFormatService",function(e,t){return function(n){return e("date")(n,t.getDateFormat())}}])},e}(),A=function(){function t(){}return t.add=function(t){t.filter("odinNumber",function(){return function(t){return e.NumUtil.format(t)}})},t}(),B=function(){function e(){}return e.add=function(e){e.filter("odinLang",["odinLanguageService",function(e){return function(t){return e.tryGet()[t]}}])},e}(),P=function(){function e(){}return e.add=function(e){e.directive("odinLang",["odinLanguageService",function(e){return{scope:!1,link:function(t,n,i){var r;i.$observe("odinLang",function(t){t&&t!=r&&(r=t,e.get().then(function(e){var i=e[t];i&&n.text(i)}))})}}}])},e}(),R=function(){function e(){}return e.add=function(e){e.directive("odinLangAttr",["odinLanguageService",function(e){return{scope:!1,link:function(t,n,i){var r;i.$observe("odinLangAttr",function(n){n&&n!=r&&(r=n,e.get().then(function(e){var r=t.$eval(n);for(var o in r){
var a=e[r[o]];a&&i.$set(o,a)}}))})}}}])},e}(),k=function(){function e(e,t,n,i,r,o,a,s){this.rootScope=e,this.componentService=t,this.applicationService=n,this.languageService=i,this.messageService=r,this.storageService=o,this.browseService=a,this.formatService=s}return e.add=function(t){t.service("odinService",e)},e.$inject=["$rootScope","odinComponentService","odinApplicationService","odinLanguageService","odinMessageService","odinStorageService","odinBrowseService","odinFormatService"],e}(),N=function(){function e(){}return e.add=function(t){t.directive("odinToUpper",[function(){return{restrict:"A",require:"ngModel",link:function(t,n,i,r){e.addCustomConverters(r)}}}])},e.addCustomConverters=function(t){t.$parsers.push(function(t){return e.parse(t)})},e.parse=function(e){return(e||"").toUpperCase()},e.format=function(e){return(e||"").toLowerCase()},e}();e.ToUpperDirective=N;var F=function(){function t(){}return t.init=function(){var t=angular.module("odin",["ui.bootstrap"]);i.add(t),e.MessageService.add(t),u.add(t),c.add(t),k.add(t),o.add(t),n.add(t),L.add(t),e.FormatService.add(t),e.DataProviderService.add(t),p.add(t),m.add(t),h.add(t),e.FocusDirective.add(t),e.KeyboardDirective.add(t),e.MouseDirective.add(t),e.NumberDirective.add(t),O.add(t),M.add(t),S.add(t),x.add(t),C.add(t),b.add(t),f.add(t),I.add(t),y.add(t),w.add(t),E.add(t),e.DataProviderDirective.add(t),N.add(t),P.add(t),R.add(t),e.Mashup.Directive.add(t),e.Mashup.ControlDirective.add(t),B.add(t),D.add(t),A.add(t),e.Templates.cacheTemplatesInModule(),e.Log.info("[Odin] Framework version "+e.Framework.version.full)},t}();F.init()}(Odin||(Odin={}));var M3;!function(e){var t=function(){function e(){}return e.scopeNameFormCtrl="m3FormCtrl",e.dateFormat="yyMMdd",e}();e.Constants=t;var n=function(){function e(){}return e.MI="MI",e.FORM="FORM",e}();e.M3ErrorTypes=n,function(e){e[e.MI=1]="MI"}(e.BrowseServiceType||(e.BrowseServiceType={}));var i=(e.BrowseServiceType,function(){function e(){}return e}());e.BrowseConfiguration=i;var r=function(){function e(){}return e.overrideUrl=function(t){Odin.Log.debug("[M3] Overriding base URL with "+t),e.url=t},e.getUrl=function(){return e.url},e.getLanguageTag=function(e){var t=this.languageMap[e];return t||(t="en-US",Odin.Log.warning("M3 language "+e+" not found. Fallback to "+t)),t},e.getDateFormat=function(e){var n=t.dateFormat;switch(e){case"YMD":case"YYMMDD":n="yyMMdd";break;case"YYYYMMDD":n="yyyyMMdd";break;case"MDY":case"MMDDYY":n="MMddyy";break;case"MMDDYYYY":n="MMddyyyy";break;case"DMY":case"DDMMYY":n="ddMMyy";break;case"DDMMYYYY":n="ddMMyyyy"}return n},e.url="",e.languageMap={CS:"zh-CN",CZ:"cs-CZ",DE:"de-DE",DK:"da-DK",ES:"es-ES",FI:"fi-FI",FR:"fr-FR",GB:"en-US",HU:"hu-HU",IT:"it-IT",JP:"ja-JP",NL:"nl-NL",NO:"nb-NO",PL:"pl-PL",PT:"pt-PT",SE:"sv-SE",TR:"tr-TR"},e}();e.Configuration=r}(M3||(M3={}));var M3;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.program=null,this.transaction=null}return __extends(t,e),t}(Odin.ErrorState);e.MIResponse=t;var n=function(){function n(){}return n.createUrl=function(t,n){var i=t+"/m3api-rest/execute/"+n.program+"/"+n.transaction,r=100,o="true",a="true",s=null;n.maxReturnedRecords>=0&&(r=n.maxReturnedRecords),n.excludeEmptyValues||(o="false"),n.outputFields&&n.outputFields.length>0&&(s=n.outputFields.join(",")),n.includeMetadata?(a="true",n.includeMetadata=!0):n.includeMetadata=!1,i+=";metadata="+a+";maxrecs="+r+";excludempty="+o;var l=n.company,c=n.division,u=e.UserContext.current;!l&&u&&(l=u.currentCompany,c=u.currentDivision),l&&(i+=";cono="+l,(c||""===c)&&(i+=";divi="+c)),s&&(i+=";returncols="+s),i+="?";var d=n.record;if(d)for(var p in d)if(d.hasOwnProperty(p)){var h=d[p];null!=h&&(i+="&"+p+"="+encodeURIComponent(h))}return i+="&_rid="+Odin.Util.random()},n.parseMessage=function(e,t){var n=t["@code"],i=t["@field"],r=t["@type"],o=t.Message;o&&(n&&(o=o.replace(n,"")),i&&(o=o.replace(i,"")),e.errorMessage=o.trim()),e.errorCode=n?n:r,e.errorField=i,e.errorType=t["@type"]},n.parseResponse=function(e,r){Odin.Log.isDebug()&&Odin.Log.debug(n.logPrefix+" Parsing MI call "+e.program+" "+e.transaction+" content: "+r);var o=new t;o.tag=e.tag;var a=[];o.items=a,o.program=e.program,o.transaction=e.transaction,n.parseMessage(o,r);var s=null;e.includeMetadata&&(s=n.getMetadata(r),o.metadata=s);var l=r.MIRecord;if(null==l||l.length<1)return o;for(var c=e.typedOutput,u=0;u<l.length;u++){var d=l[u];if(null!=d){var p=new i;if(p.metadata=s,d.NameValue)for(var h=0;h<d.NameValue.length;h++){var f=d.NameValue[h],g=f.Name,v=f.Value;null!=v&&(v=Odin.StringUtil.trimEnd(v)),c?p[g]=this.getTypedValue(g,v,s):p[g]=v}a.push(p)}}return a.length>0&&(o.item=a[0]),Odin.Log.debug(n.logPrefix+"Received "+a.length+" record(s)"),o},n.getTypedValue=function(e,t,n){try{if(n){var i=n[e];if(!i)return t;var r=this.parseValue(t,i);return r}return t}catch(e){return t}},n.parseValue=function(e,t){return t.isString()?e:t.isNumeric()?Odin.StringUtil.isNullOrEmpty(e)?0:+e:t.isDate()?Odin.StringUtil.isNullOrEmpty(e)?null:r.getDate(e):e},n.getMetadata=function(e){try{var t=e.Metadata;if(t&&t.Field&&t.Field.length>1){var n={},i=t.Field;for(var r in i)if(i.hasOwnProperty(r)){var o=t.Field[r],s=o["@name"],l=new a(s,o["@length"],o["@type"],o["@description"]);n[s]=l}return n}}catch(t){Odin.Log.error(this.logPrefix+"Failed to check for metadata "+e.Metadata)}return null},n.logPrefix="[MIAccess] ",n}();e.MIAccess=n;var i=function(){function e(){this.metadata=null}return e.prototype.setNumberString=function(e,t){this[e]=t.toString()},e.prototype.setNumber=function(e,t){this[e]=t},e.prototype.setDateString=function(e,t){this[e]=r.getDateFormatted(t)},e.prototype.setDate=function(e,t){this[e]=t},e.prototype.setString=function(e,t){this[e]=t},e}();e.MIRecord=i;var r=function(){function e(){}return e.toMIFormat=function(t){return Odin.Util.hasValue(t)?Odin.DateUtil.isDate(t)?e.getDateFormatted(t):t.toString():""},e.createUpdateRecord=function(t,n,r,o){var a=new i,s=angular.copy(r);if(null!=o&&o.length>0)for(var l=0;l<o.length;l++){var c=o[l];Odin.ArrayUtil.contains(s,c)||s.push(c)}return s.forEach(function(i,r){var s=t[i],l=n[i];Odin.ArrayUtil.contains(o,i)?Odin.Util.hasValue(l)?a[i]=e.toMIFormat(l):a[i]=e.toMIFormat(s):Odin.Util.hasValue(l)&&l!==s&&(a[i]=l)}),Odin.Log.debug("[MIUtil.createUpdateRecord] returns update record: "+a),a},e.getDateFormatted=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),i=e.getDate().toString();return t+(2===n.length?n:"0"+n[0])+(2===i.length?i:"0"+i[0])},e.getDate=function(e){try{var t=e,n=+t.substring(0,4),i=+t.substring(4,6),r=+t.substring(6,8);return new Date(n,i-1,r)}catch(t){var o="MIUtil.getDate failed to parse format yyyyMMdd for: "+e;throw Odin.Log.debug(o),o}},e.metadataToArray=function(e){var t=new Array;for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];t.push(i)}return t},e}();e.MIUtil=r;var o=function(){function e(){}return e.datePattern="yyyyMMdd",e.decimalSeparator=".",e}();e.MIConstants=o;var a=function(){function e(e,t,n,i){this.name=e,this.length=t,this.description=i,this.setType(n)}return e.prototype.isNumeric=function(){return this.type===s.Numeric},e.prototype.isDate=function(){return this.type===s.Date},e.prototype.isString=function(){return this.type===s.String},e.prototype.setType=function(e){"D"===e?this.type=s.Date:"N"===e?this.type=s.Numeric:"A"===e&&(this.type=s.String)},e}();e.MIMetadataInfo=a,function(e){e[e.String=0]="String",e[e.Numeric=1]="Numeric",e[e.Date=2]="Date"}(e.MIDataType||(e.MIDataType={}));var s=e.MIDataType;!function(e){e[e.Array=0]="Array",e[e.Dictionary=1]="Dictionary"}(e.MIOptionsType||(e.MIOptionsType={}));var l=e.MIOptionsType,c=function(){function e(e,t){this.miService=e,this.miOptions=t}return e.prototype.get=function(e){var t=this,n=this.miService.q.defer(),i=this.miOptions;return this.miService.executeRequest(i).then(function(e){var i=e;i.items=t.onResponseDoMappings(i),t.miOptions.type===l.Dictionary&&(i.items=t.onResponseCreateDirectory(i)),n.resolve(i)},function(e){n.reject(e)}),n.promise},e.prototype.onResponseDoMappings=function(e){var t=e.items,n=this.miOptions.outputMap;for(var i in n)n.hasOwnProperty(i)&&t.forEach(function(e,t){e[n[i]]=e[i],delete e[i]});return t},e.prototype.onResponseCreateDirectory=function(e){var t=e.items,n={},i=this.miOptions.dictionaryKey;return t.forEach(function(e,t){var r=e[i];n[r]=e}),n},e.$inject=["m3MIService"],e}();e.MIDataProvider=c}(M3||(M3={}));var M3;!function(e){var t=function(e){function t(t,n,i){void 0===i&&(i=null),e.call(this,t,n.odinService,i),this.miService=n,this.prefixCtrl="[M3.MICtrl] ",this.isUpdate=!1}return __extends(t,e),t.prototype.onResponse=function(e){this.isUpdate=!1},t.prototype.onError=function(e){this.isUpdate=!1;var t=e.errorMessage;Odin.Log.error(this.prefixCtrl+t),this.miService.odinService.messageService.showError(t)},t.prototype.execute=function(e,t,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var r={program:e,transaction:t,record:n,outputFields:i};return this.executeRequest(r)},t.prototype.executeUpdate=function(e,t,n,i){return void 0===n&&(n=null),void 0===i&&(i=null),this.isUpdate=!0,this.execute(e,t,n,i)},t.prototype.executeRequest=function(e){var t=this;if(this.isBusy())throw"Execute is not allowed when the component context is busy";var n=this.miService.q.defer();if(this.defaultOptions){var i=angular.copy(this.defaultOptions);angular.extend(i,e),e=i}return!e.outputFields&&this.outputFields&&(e.outputFields=this.outputFields),this.setBusy(),this.miService.executeRequest(e).then(function(e){t.setActive(),t.onResponse(e),n.resolve(e)},function(e){t.setActive(),t.onError(e),n.reject(e)}),n.promise},t.prototype.executeUpdateRequest=function(e){return this.isUpdate=!0,this.executeRequest(e)},t.injectDefault=["$scope","m3MIService"],t}(Odin.BaseCtrl);e.MICtrl=t;var n=function(e){function t(t,n,i){void 0===i&&(i=null),e.call(this,t,n,i),this.scope=t,this.miService=n,this.prefixDetailCtrl="[M3.MIDetailCtrl] ",this.detailScope=t}return __extends(t,e),t.prototype.clear=function(){this.scope.item={},Odin.Log.debug(this.prefixDetailCtrl+"Cleared detail item")},t.prototype.onResponse=function(e){this.isUpdate||(this.detailScope.item=e.item),this.isUpdate=!1,Odin.Log.debug(this.prefixDetailCtrl+"Received item.")},t}(t);e.MIDetailCtrl=n;var i=function(e){function t(t,n){e.call(this,t,n),this.scope=t,this.miService=n,this.prefixListCtrl="[M3.MIListCtrl] ",this.isPaging=!1,this.isEndOfList=!1,this.listScope=t}return __extends(t,e),t.prototype.initialize=function(e){var t=this;e=Odin.DefaultListCtrlOptions.get(e),this.listOptions=e;var n=e.gridOptions;n||(n={}),n.data||(n.data=e.scopeNameGridData),n.multiSelect!==!0&&(n.multiSelect=!1),n.enableColumnResize!==!1&&(n.enableColumnResize=!0),n.enableSorting!==!0&&(n.enableSorting=!1),n.enableColumnMenus!==!0&&(n.enableColumnMenus=!1),n.enableRowSelection=!0,n.enableRowHeaderSelection=!1,n.enableGridMenu=!1,n.onRegisterApi||(n.onRegisterApi=function(n){t.gridApi=n,n.selection.on.rowSelectionChanged(t.scope,function(e){t.rowSelectionChanged(e)}),e.enableGridInfiniteScroll&&t.gridApi.infiniteScroll.on.needLoadMoreData(t.listScope,function(){t.gridApi.infiniteScroll.saveScrollPercentage(),t.notifyScroll()})}),this.listScope[e.scopeNameGridOptions]=n},t.prototype.getItems=function(){return this.scope[this.listOptions.scopeNameGridData]},t.prototype.setItems=function(e){this.scope[this.listOptions.scopeNameGridData]=e},t.prototype.getGridApi=function(){return this.gridApi},t.prototype.setGridApi=function(e){this.gridApi=e},t.prototype.executeRequest=function(t){return this.isPaging===!1&&(this.isEndOfList=!1),e.prototype.executeRequest.call(this,t)},t.prototype.notifyScroll=function(){if(!this.isPaging){Odin.Log.isTrace()&&Odin.Log.trace(this.prefixListCtrl+"Scroll detected");try{var e=this.getItems();if(e&&e.length>0){var t=Odin.ArrayUtil.last(e),n=this.onGridScroll(t);n?(this.isPaging=!0,this.executeRequest(n)):Odin.Log.warning("onGridScroll needs to return the MIRequest for the next page.")}else Odin.Log.isTrace()&&Odin.Log.trace(this.prefixListCtrl+"No items so it is not possible to get last item - ignoring scroll")}catch(e){Odin.Log.error(this.prefixListCtrl+"Automatic scroll failed."+e)}}},t.prototype.onGridScroll=function(e){return null},t.prototype.onActive=function(e){e&&this.pendingItem&&(Odin.Log.debug(this.prefixListCtrl+"Delivering delayed selection changed event"),this.rowSelectionChanged(this.pendingItem,this.pendingEvent),this.pendingItem=null,this.pendingEvent=null)},t.prototype.onSelectedItemChanged=function(e){},t.prototype.rowSelectionChanged=function(e,t){var n=e.isSelected?e.entity:null;this.getComponentContext().isActive()?this.onSelectedItemChanged(n):(Odin.Log.debug(this.prefixListCtrl+"Selection changed event delayed"),this.pendingItem=e,this.pendingEvent=t)},t.prototype.clear=function(){this.isEndOfList=!1,this.setItems([]),Odin.Log.debug(this.prefixListCtrl+"Cleared list items.")},t.prototype.onResponse=function(e){var t=e.items;if(Odin.Log.trace(this.prefixListCtrl+"Received "+t.length+" records(s)."),this.isPaging){this.updateListRows(e);var n=this.gridApi;n&&n.infiniteScroll.dataLoaded()}else this.setItems(t)},t.prototype.onError=function(t){e.prototype.onError.call(this,t),this.isPaging&&(this.isPaging=!1,this.isEndOfList=!0,Odin.Log.error(this.prefixListCtrl+"Failed to get new roles after scroll "+t.errorMessage))},t.prototype.updateListRows=function(e){var t=this.getItems(),n=e.items,i=n.length;if(1===i||0===i)return void(this.isEndOfList=!0);for(var r=1;r<i;r++)t.push(n[r]);Odin.Log.debug(this.prefixListCtrl+"Added "+i+" list rows."),this.isPaging=!1},t.prototype.resize=function(){var e=this.gridApi;e&&e.core.handleWindowResize()},t}(t);e.MIListCtrl=i}(M3||(M3={}));var M3;!function(e){var t;!function(e){var t=function(){function e(){}return e.fieldInformationCategory="WWIBCA",e.fieldNumberOfFilters="WWNFTR",e.fieldHideCommandBar="WWHICB",e}();e.BEConstants=t;var n=function(){function e(){this.isNumeric=!1,this.isUpper=!1,this.maxLength=0,this.maxDecimals=0}return e}();e.Constraint=n;var i=function(){function e(){}return e}();e.Position=i;var r=function(){function e(){}return e.getName=function(t){switch(t){case e.label:return"Label";case e.textBox:return"TextBox";case e.checkBox:return"CheckBox";case e.comboBox:return"ComboBox";case e.datePicker:return"DatePicker";case e.groupBox:return"GroupBox";case e.button:return"Button";case e.list:return"List";case e.listColumn:return"ListColumn"}return null},e.label=1,e.textBox=2,e.checkBox=3,e.comboBox=4,e.datePicker=5,e.groupBox=6,e.button=7,e.list=8,e.listColumn=9,e}();e.ControlType=r;var o=function(){function e(e){this.type=e}return e.prototype.getTypeName=function(){return r.getName(this.type)},e.prototype.getLeft=function(){return this.position?this.position.left:-1},e.prototype.getTop=function(){return this.position?this.position.top:-1},e.prototype.getWidth=function(){return this.position?this.position.width:-1},e}();e.FormControl=o;var a=function(t){function n(){t.call(this,r.listColumn)}return __extends(n,t),n.prototype.isNumeric=function(){return null!=this.constraint&&this.constraint.isNumeric||null!=this.columnType&&("S"==this.columnType||"P"==this.columnType)},n.prototype.isDate=function(){return e.XmlNames.categoryDate===this.category},n.prototype.isBool=function(){return e.XmlNames.categoryBool===this.category},n}(o);e.ListColumn=a;var s=function(){function e(){}return e}();e.ListRow=s;var l=function(){function e(){}return e}();e.ListCell=l;var c=function(e){function t(){e.call(this,r.list),this.columns=[],this.items=[]}return __extends(t,e),t}(o);e.List=c;var u=function(e){function t(t){void 0===t&&(t=r.textBox),e.call(this,t)}return __extends(t,e),t}(o);e.TextBox=u;var d=function(e){function t(){e.call(this,r.label)}return __extends(t,e),t}(o);e.Label=d;var p=function(e){function t(){e.call(this,r.button)}return __extends(t,e),t}(o);e.Button=p;var h=function(e){function t(){e.call(this,r.groupBox)}return __extends(t,e),t}(o);e.GroupBox=h;var f=function(e){function t(){e.call(this,r.checkBox)}return __extends(t,e),t}(o);e.CheckBox=f;var g=function(){function e(){}return e}();e.ComboBoxItem=g;var v=function(e){function t(){e.call(this,r.comboBox),this.items=[]}return __extends(t,e),t}(o);e.ComboBox=v;var m=function(e){function t(t,n){e.call(this,r.datePicker),this.dateFormat=t,this.hideDateFormat=n}return __extends(t,e),t}(u);e.DatePicker=m;var y=function(){function e(){}return e}();e.FunctionKey=y;var b=function(){function e(){}return e}();e.Option=b;var S=function(){function e(){this.controls={},this.controlList=[]}return e}();e.Panel=S;var C=function(){function e(){}return e.valueTrue="1",e.valueFalse="0",e}();e.Protocol=C;var x=function(){function e(){}return e.getSource=function(e){return e.source?e.source:"Web"},e.add=function(e,t,n){t&&n&&(e[t]=n)},e.addBool=function(e,t,n){t&&(e[t]=n?"True":"False")},e.addValue=function(e,t,n){return e.length>0&&(e+=","),e+t+","+encodeURIComponent(n)},e.addInformationCategory=function(n,i){n=e.addValue(n,t.fieldInformationCategory,i.informationCategory);var r=i.numberOfFilters;return r||(r="0"),n=e.addValue(n,t.fieldNumberOfFilters,r)},e.createValues=function(t,n,i,r){for(var o="",a=n.split(","),s=0;s<a.length;s++){var l=a[s],c=i[l];if(""===c||!c&&r)if(r&&l.length>4){var u=l.slice(2),d=i[u];d&&d.length>0?c=d:t&&("CONO"==u?c=t.currentCompany:"DIVI"==u&&(c=t.currentDivision)),c||(c=" ")}else c=" ";c&&(o=e.addValue(o,l,c))}return o},e.toUri=function(t,n){var i=e.toParams(t,n),r="",o=e.nameMap;for(var a in i){var s=o[a]||a;r&&(r+="&"),r+=s+"="+encodeURIComponent(i[a])}var l="bookmark?"+r;return l},e.toParams=function(t,n){var i=t.params||{};this.add(i,"BM_PROGRAM",t.program),this.add(i,"BM_PANEL_SEQUENCE",t.panelSequence),this.add(i,"BM_START_PANEL",t.startPanel),this.add(i,"BM_PANEL",t.panel),this.add(i,"BM_FOCUS_FIELD_NAME",t.focusFieldName),this.add(i,"BM_TABLE_NAME",t.table),this.add(i,"BM_OPTION",t.option),this.add(i,"BM_INQUIRY_TYPE",t.sortingOrder),this.add(i,"BM_SOURCE",this.getSource(t)),this.add(i,"BM_VIEW",t.view),this.add(i,"BM_AUTOMATION",t.automation),this.add(i,"BM_AUTOMATION_TEMPLATE",t.automationTemplate),this.addBool(i,"BM_INCLUDE_START_PANEL",t.includeStartPanel),this.addBool(i,"BM_REQUIRE_PANEL",t.requirePanel),this.addBool(i,"BM_SUPPRESS_CONFIRM",t.suppressConfirm),t.isStateless&&this.addBool(i,"BM_STATELESS",!0);var r=t.values,o=t.keys;t.keyNames&&r&&(o=e.createValues(n,t.keyNames,r,!0)),this.add(i,"BM_KEY_FIELDS",o);var a=t.parameters;t.parameterNames&&r&&(a=e.createValues(n,t.parameterNames,r,!1)),this.add(i,"BM_PARAMETERS",a);var s=t.fields,l=t.informationCategory;return(t.fieldNames&&r||l)&&(s=e.createValues(n,t.fieldNames,r,!1),l&&(s=e.addInformationCategory(s,t))),this.add(i,"BM_START_PANEL_FIELDS",s),i},e.nameMap={BM_PROGRAM:"program",BM_TABLE_NAME:"tablename",BM_PANEL:"panel",BM_KEY_FIELDS:"keys",BM_OPTION:"option",BM_START_PANEL:"startpanel",BM_FOCUS_FIELD_NAME:"focus",BM_PANEL_SEQUENCE:"panelsequence",BM_INCLUDE_START_PANEL:"includestartpanel",BM_INQUIRY_TYPE:"sortingorder",BM_VIEW:"view",BM_SOURCE:"source",BM_STATELESS:"stateless",BM_START_PANEL_FIELDS:"fields",BM_PARAMETERS:"parameters",BM_AUTOMATION:"automation",BM_AUTOMATION_TEMPLATE:"automationtemplate",BM_SUPPRESS_CONFIRM:"requirepanel",BM_REQUIRE_PANEL:"suppressconfirm"},e}();e.Bookmark=x}(t=e.Form||(e.Form={}))}(M3||(M3={}));var M3;!function(e){var t;!function(e){var t=function(){function e(){}return e.elementRoot="Root",e.elementResult="Result",e.elementControlData="ControlData",e.elementSessionData="SessionData",e.elementSessionId="SID",e.elementInstanceId="IID",e.elementJobId="JobId",e.elementHelpUrl="HelpURL",e.elementMomUrl="momUrl",e.elementUser="User",e.elementCompany="Cmp",e.elementDivision="Divi",e.elementVersion="ERPV",e.elementLanguage="Lng",e.elementPanels="Panels",e.elementPanel="Panel",e.elementObjects="Objs",e.elementPanelHeader="PHead",e.elementPanelDescription="PDesc",e.elementEntryField="EFld",e.elementCheckBox="ChkBox",e.elementCaption="Cap",e.elementComboBox="CBox",e.elementButton="Btn",e.elementGroupBox="GroupBox",e.elementPluggable="Pluggable",e.elementTextArea="TextArea",e.elementBarChart="BarChart",e.elementJGanttData="JGanttData",e.elementList="List",e.elementRunDialog="RunDlg",e.elementOpenDialog="OpenDlg",e.elementCloseDialog="CloseDlg",e.elementOpenModal="OpenModal",e.elementStateless="Stateless",e.elementFocus="Focus",e.elementFocusOriginal="FO",e.elementFocusType="FT",e.elementBookmark="Bookmark",e.elementSearch="Search",e.elementChangedBy="ChgBy",e.elementModifiedDate="ModDate",e.elementRegisteredDate="RegDate",e.elementMessage="Msg",e.elementMessageId="MsgID",e.elementMessageLevel="MsgLvl",e.elementListCell="LC",e.elementDateFormat="DF",e.elementDecimalSeparator="DSep",e.elementComboBoxValue="CBV",e.elementPosition="Pos",e.elementConstraints="Constr",e.elementFunctionKeys="FKeys",e.elementFunctionKey="FKey",e.elementBasicOptions="BasicOpts",e.elementBasicOption="BO",e.elementRelatedOptions="MoreOpts",e.elementRelatedOption="MO",e.elementSortingOrderComboBox="InqTypeCBox",e.elementSortingOrderEntryField="InqTypeEFld",e.elementViewComboBox="PanelVerCBox",e.elementViewEntryField="PanelVerEFld",e.elementVPanels="VPanels",e.elementP="p",e.elementPanelSequence="PSeq",e.elementProgramInfo="PgmInfo",e.elementCustomization="Cust",e.elementDocumentLinks="DocLinks",e.elementDocumentLink="DL",e.attributeType="type",e.attributeName="name",e.attributeOriginalName="oname",e.attributeValue="val",e.attributeHelp="hlp",e.attributeCommand="cmd",e.attributeAccess="acc",e.attributeStyle="style",e.attributeJustification="just",e.attributeProtected="prot",e.attributeSelected="sel",e.attributeScrollToEnd="scrollEnd",e.attributeEnd="end",e.attributeTab="tab",e.attributeTop="t",e.attributeLeft="l",e.attributeWidth="w",e.attributeHeight="h",e.attributeClear="clr",e.attributeAdditionalInfo="addInfo",e.attributeMaxLength="maxL",e.attributeMaxDecimals="maxD",e.attributeUpperCase="uc",e.attributeStartPanel="sP",e.attributePanelIndex="iP",e.attributeDescription="desc",e.attributeList="list",e.attributeSupportsSearch="s",e.attributeSupportsBookmarks="bm",e.attributeReferenceFile="rfl",e.attributeReferenceField="rfd",e.attributeArgument="arg",e.attributeProgId="progId",e.attributeMasterColumn="masterColumn",e.attributeCategory="cat",e.valueWriteDisabled="WD",e.valueWriteEnabled="WE",e.valueHidden="HN",e.valueReadDisabled="RD",e.valueStyleReverse="REV",e.valueStyleReverseIntensity="REVINT",e.valueStyleHighIntensity="HIGHINT",e.valueDecimal="DECIMAL",e.valueChecked="on",e.valueFocusTypeListCell="LC",e.valueFocusTypeListRow="LR",e.categoryBool="BOOL",e.categoryDate="DATE",e}();e.XmlNames=t;var n=function(){function e(){}return e.getAttribute=function(e,t){var n=e.hasAttributes()?e.attributes.getNamedItem(t):null;return null!=n?n.textContent:null},e.hasAttribute=function(t,n){return null!=e.getAttribute(t,n)},e.getBoolAttribute=function(e,t,n){var i=this.getAttribute(e,t);return Odin.Util.getBoolean(i,n)},e.getIntAttribute=function(e,t,n){var i=this.getAttribute(e,t);return Odin.NumUtil.getInt(i,n)},e.selectNodes=function(t,n){var i=[];return e.select(t,n.split("/"),i),i},e.select=function(t,n,i){var r,o=n[0];if(1!=n.length)r=e.selectNode(t,o),r&&(n.splice(0,1),e.select(r,n,i));else for(var a=0;a<t.childNodes.length;a++)r=t.childNodes[a],r.localName===o&&i.push(r)},e.selectNode=function(e,t){if(e.hasChildNodes())for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.localName===t)return i}return null},e.getElementInt=function(t,n,i){var r=e.getElement(t,n);return r?parseInt(r):i},e.getElement=function(e,t){var n=this.selectNode(e,t);return null!=n?n.textContent:null},e.getText=function(e){return e?e.textContent:null},e}();e.XmlUtil=n;var i=function(){function e(){}return e}();e.ParserInfo=i;var r=function(){function i(){}return i.parseXml=function(e){return i.domParser||(i.domParser=new DOMParser),i.domParser.parseFromString(e,"text/xml")},i.prototype.parseName=function(e){return n.getAttribute(e,t.attributeName)},i.prototype.generateName=function(e,t,n){return e+"_L"+t+"T"+n},i.prototype.parseSession=function(e,i){i.sessionId=n.getElement(e,t.elementSessionId),i.sessionId&&(i.instanceId=n.getElement(e,t.elementInstanceId)),i.result=n.getElementInt(e,t.elementResult,0),i.language=n.getElement(e,t.elementLanguage)},i.selectRoot=function(e){return n.selectNode(e,t.elementRoot)},i.prototype.parseReponse=function(r){var o=i.parseXml(r),a=new e.Response;a.counter=++i.counter,this.uniqueNames={};var s=i.selectRoot(o);if(s){var l=n.selectNode(s,t.elementSessionData);l?this.parseSession(l,a):(a.result=n.getElementInt(s,t.elementResult,0),a.message=n.getElement(s,t.elementMessage));var c=o.getElementsByTagName(t.elementPanel);if(null==c)return a;for(var u=0;u<c.length;u++)this.parsePanel(c[u],a)}return a},i.prototype.parsePosition=function(i){var r=n.selectNode(i,t.elementPosition);if(null==r)return null;var o=new e.Position;return o.top=n.getIntAttribute(r,t.attributeTop,0),o.left=n.getIntAttribute(r,t.attributeLeft,0),o.width=n.getIntAttribute(r,t.attributeWidth,0),o.height=n.getIntAttribute(r,t.attributeHeight,0),o},i.prototype.parseAccess=function(e,i){var r=n.getAttribute(e,t.attributeAccess),o=!0,a=!0;t.valueWriteDisabled==r?a=!1:t.valueHidden==r?o=!1:t.valueReadDisabled==r&&(i.isReadDisabled=!0),i.isEnabled=a,i.isVisible=o},i.prototype.parseConstraints=function(i){var r=n.selectNode(i,t.elementConstraints);if(null==r)return null;var o=new e.Constraint;return o.maxLength=n.getIntAttribute(r,t.attributeMaxLength,0),o.isNumeric=n.getAttribute(r,t.attributeType)==t.valueDecimal,o.isNumeric?o.maxDecimals=n.getIntAttribute(r,t.attributeMaxDecimals,0):o.isUpper=n.hasAttribute(r,t.attributeUpperCase),o},i.prototype.parseStyle=function(e,i){var r=n.getAttribute(e,t.attributeStyle);if(null!=r)switch(r){case t.valueStyleReverse:i.isReverse=!0;break;case t.valueStyleHighIntensity:i.isHighIntensity=!0;break;case t.valueStyleReverseIntensity:i.isReverse=!0,i.isHighIntensity=!0}},i.prototype.parseElement=function(e,t){this.parseAccess(e,t),t.position=this.parsePosition(e)},i.prototype.parseInputElement=function(e,i){this.parseElement(e,i),i.name||(i.name=this.parseName(e)),i.originalName=n.getAttribute(e,t.attributeOriginalName),i.tabIndex=n.getIntAttribute(e,t.attributeTab,-1),i.fieldHelp=n.getAttribute(e,t.attributeHelp);var r=n.getAttribute(e,t.attributeReferenceFile);r&&(i.referenceFile=r,i.referenceField=n.getAttribute(e,t.attributeReferenceField)),i.constraint=this.parseConstraints(e)},i.prototype.parseButton=function(i){var r=new e.Button;r.name=this.parseName(i),r.value=i.textContent,this.parseInputElement(i,r);var o=n.getAttribute(i,t.attributeProgId);return null!=o?(r.progId=o,r.arguments=n.getAttribute(i,t.attributeArgument)):(r.command=n.getAttribute(i,t.attributeCommand),r.commandValue=n.getAttribute(i,t.attributeValue)),r},i.prototype.parseGroupBox=function(t){var i=new e.GroupBox;return this.parseElement(t,i),i.position&&(i.name=this.generateName("GRP",i.position.left,i.position.top)),i.isLine=n.getBoolAttribute(t,"r",!1),i.value=t.textContent,i},i.prototype.parseLabel=function(t){var i=new e.Label;this.parseElement(t,i);var r=n.getAttribute(t,"id");i.id=r,i.value=t.textContent;var o=i.position;return o&&(!r||r.length<2?r=this.generateName("LBL",o.left,o.top):this.uniqueNames[r]?r=this.generateName("LBL",o.left,o.top):this.uniqueNames[r]=r),i.name=r,i.toolTip=n.getAttribute(t,"tip"),i.isFixed=n.getBoolAttribute(t,"fixFnt",!1),i.isAdditionalInfo=n.getBoolAttribute(t,"addInfo",!1),i.isEmphasized=n.getBoolAttribute(t,"emp",!1),i.isColon=n.getBoolAttribute(t,"cl",!1),i},i.prototype.parseCheckBox=function(t){var n=new e.CheckBox;return this.parseInputElement(t,n),n.value=t.textContent,n.isChecked="1"===n.value,n},i.prototype.parseComboBox=function(i,r){var o=new e.ComboBox;o.name=this.parseName(i),o.isPosition=r,this.parseInputElement(i,o),null!=n.getAttribute(i,"e")&&(o.isEditable=!0,o.value=n.getAttribute(i,t.attributeValue));var a=i.childNodes;if(a)for(var s=0;s<a.length;s++){var l=a[s];if(l.localName===t.elementComboBoxValue){var c=new e.ComboBoxItem;c.value=n.getAttribute(l,t.attributeValue),c.text=l.textContent,n.hasAttribute(l,t.attributeSelected)&&(o.selected=c,c.isSelected=n.hasAttribute(l,t.attributeSelected),o.value||(o.value=c.value)),o.items.push(c)}}return o.command=n.getAttribute(i,t.attributeCommand),null!=o.command&&(o.commandValue=n.getAttribute(i,t.attributeValue)),r&&(o.isEnabled=!0,o.isVisible=!0),o},i.prototype.parseTextBox=function(i,r,o){var a,s=n.getAttribute(i,"df");return a=null==s||r||s.indexOf("YYWWD")>=0?new e.TextBox:new e.DatePicker(s,n.getBoolAttribute(i,"hDf",!1)),a.name=this.parseName(i),a.value=i.textContent,this.parseInputElement(i,a),this.parseStyle(i,a),r?(a.isEnabled=!0,a.isVisible=!0):a.isBrowsable=n.hasAttribute(i,"browse"),a.isRightAligned=n.hasAttribute(i,t.attributeJustification),null!=o&&(name==e.BEConstants.fieldInformationCategory?o.informationCategory=a.value:name==e.BEConstants.fieldHideCommandBar&&"1"===a.value&&(o.hideCommandBar=!0)),a},i.prototype.getStringTrimEnd=function(e){var t=n.getText(e);return t?Odin.StringUtil.trimEnd(t):null},i.prototype.getRowIndex=function(e){try{return parseInt(e.substring(1))-1}catch(e){}return-1},i.prototype.parseListRow=function(i,r){var o=n.selectNodes(i,t.elementListCell);if(!o)return null;var a=new e.ListRow;a.items=[],a.name=n.getAttribute(i,t.attributeName),a.columnCount=o.length,a.isProtected=n.hasAttribute(i,t.attributeProtected),a.isSelected=n.hasAttribute(i,t.attributeSelected);for(var s=!0,l=0;l<o.length;l++){var c=r.columns[l],u=o[l],d=new e.ListCell,p=this.getStringTrimEnd(u);a[c.fullName]=p,d.text=p,d.isRight=n.hasAttribute(u,t.attributeJustification),d.isBool=c.isBool();var h=n.getAttribute(u,t.attributeAccess);if(h)if(t.valueWriteEnabled==h){if(s){d.isUpper=c.isUpperCase;var f=c.maxLength;c.isNumeric&&(f+=c.maxDecimals>0?2:1),d.maxLength=f,d.isEditable=!0,d.isEnabled=!0}}else t.valueHidden==h&&(d.isHidden=!0);d.isBool&&(d.isChecked=e.Protocol.valueTrue===d.text,d.isEditable||(d.isChecked?d.isEditable=!0:d.isBool=!1));var g=n.getAttribute(u,t.attributeStyle);null!=g&&(t.valueStyleReverseIntensity==g?(d.isReverse=!0,d.isHighIntensity=!0):t.valueStyleReverse==g?d.isReverse=!0:t.valueStyleHighIntensity==g&&(d.isHighIntensity=!0)),a.items.push(d)}return this.parseSubRows(i,r,a),a.index=this.getRowIndex(a.name),a},i.prototype.parseSubRows=function(i,r,o){var a=n.selectNodes(i,"SR");if(a&&0!=a.length){r.hasSubRows=!0;var s=a[0],l=n.selectNodes(s,"SC");if(l){o.subItems=[];for(var c=0;c<l.length;c++){var u=l[c],d=new e.ListCell;d.text=this.getStringTrimEnd(u),d.span=n.getIntAttribute(u,"colspan",0),d.isRight=n.hasAttribute(u,t.attributeJustification),o.subItems.push(d)}}}},i.prototype.parseListRows=function(e,t){t.items=[];var i=n.selectNodes(e,"LView/LRows/LR");if(null!=i)for(var r=0;r<i.length;r++){var o=this.parseListRow(i[r],t);o&&o.index>=0&&t.items.push(o)}},i.prototype.parseSubColumns=function(e,t){var i=n.selectNodes(e,"LView/LCols/LSubCol");if(i&&0!=i.length){t.subColumns=[];for(var r=t.columns.length,o=0;o<i.length;o++){var a=this.parseColumn(i[o],r);t.subColumns.push(a),r++}}},i.prototype.parseColumnName=function(e,i){var r=i.index,o=n.getAttribute(e,t.attributeName);if(!o){if(r<0)return;o="_"+r}o=o.replace("&","");var a=o;a.length>4&&(a=a.substring(a.length-4)),Odin.NumUtil.isNumber(a[0])&&(a="_"+a),i.name=a,i.fullName=o},i.prototype.parseHeader=function(e,i){var r=n.selectNode(e,t.elementCaption);r&&(i.header=n.getText(r),i.toolTip=n.getAttribute(r,"tip"))},i.prototype.parseColumn=function(i,r){var o=new e.ListColumn;o.index=r,this.parseColumnName(i,o),this.parseHeader(i,o);var a=this.parseConstraints(i);return a&&(o.maxLength=a.maxLength,o.maxDecimals=a.maxDecimals,o.isUpperCase=a.isUpper,o.constraint=a),o.columnType=n.getAttribute(i,t.attributeType),o.category=n.getAttribute(i,t.attributeCategory),
o.width=n.getIntAttribute(i,t.attributeWidth,0),o.fieldHelp=n.getAttribute(i,t.attributeHelp),o.aggregate=n.getIntAttribute(i,"agg",0),o.aggregateDisplayRule=n.getIntAttribute(i,"adr",0),o.aggregateUpdateRule=n.getIntAttribute(i,"aur",0),o.isRight=n.hasAttribute(i,t.attributeJustification),o},i.prototype.parseColumns=function(e,i){var r=n.selectNodes(e,"LView/LCols/LCol");i.columns=[];for(var o=0,a=0;a<r.length;a++){var s=r[a],l=this.parseColumn(s,a),c=n.selectNode(s,t.elementEntryField);null!=c?l.positionField=this.parseTextBox(c,!0,null):(c=n.selectNode(s,t.elementComboBox),null!=c&&(l.positionField=this.parseComboBox(c,!0))),l.positionField&&l.fieldHelp&&(l.positionField.fieldHelp=l.fieldHelp),l.aggregate>0?i.isAggregate=!0:o++,i.columns.push(l)}i.isAggregate&&(i.aggregateDepth=o)},i.prototype.parseList=function(t,i){var r=new e.List;return r.isCleared=n.getBoolAttribute(i,"clr",!1),this.parseInputElement(i,r),this.parseColumns(i,r),this.parseSubColumns(i,r),this.parseListRows(i,r),r},i.prototype.parseObjects=function(e,n,i){for(var r=0;r<e.length;r++){var o=e[r],a=null,s=o.localName;switch(s){case t.elementButton:a=this.parseButton(o);break;case t.elementCaption:a=this.parseLabel(o);break;case t.elementCheckBox:a=this.parseCheckBox(o);break;case t.elementComboBox:a=this.parseComboBox(o,!1);break;case t.elementSortingOrderComboBox:a=this.parseComboBox(o,!1),a.isSpecial=!0,i.sortingOrderComboBox=a;break;case t.elementViewComboBox:a=this.parseComboBox(o,!1),a.isSpecial=!0,i.viewComboBox=a;break;case t.elementEntryField:a=this.parseTextBox(o,!1,i);break;case t.elementSortingOrderEntryField:a=this.parseTextBox(o,!1,i),a.isSpecial=!0,i.sortingOrderTextBox=a;break;case t.elementViewEntryField:a=this.parseTextBox(o,!1,i),a.isSpecial=!0,i.viewTextBox=a;break;case t.elementGroupBox:a=this.parseGroupBox(o);break;case t.elementList:i.list=this.parseList(n,o);break;case t.elementPanelSequence:break;case t.elementFunctionKeys:break;case t.elementBasicOptions:this.parseBasicOptions(o,i);break;case t.elementRelatedOptions:this.parseRelatedOptions(o,i);break;case t.elementDocumentLinks:break;case t.elementPluggable:break;case t.elementTextArea:break;case t.elementJGanttData:break;case t.elementBarChart:}a&&(i.controlList.push(a),a.name&&(i.controls[a.name]=a))}},i.prototype.parsePanel=function(i,r){var o=new e.Panel;o.name=this.parseName(i),o.header=n.getElement(i,t.elementPanelHeader),o.description=n.getElement(i,t.elementPanelDescription);var a=n.selectNode(i,t.elementObjects);a&&this.parseObjects(a.childNodes,r,o),r.panels.push(o),r.panel||(r.panel=o)},i.prototype.parseBasicOptions=function(e,n){n.basicOptions=this.parseOptions(e,t.elementBasicOption);var i=n.basicOptions.pop();0!=i.val&&n.basicOptions.push(i)},i.prototype.parseRelatedOptions=function(e,n){n.relatedOptions=this.parseOptions(e,t.elementRelatedOption)},i.prototype.parseOptions=function(e,t){var i=[],r=n.selectNodes(e,t);return null==r?i:(r.forEach(function(e,t){i.push({option:e.textContent,val:e.attributes.val.nodeValue})}),i)},i.parse=function(e){return(new i).parseReponse(e)},i.counter=0,i}();e.Parser=r}(t=e.Form||(e.Form={}))}(M3||(M3={}));var M3;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.result=0,this.panel=null,this.panels=[]}return __extends(t,e),t.prototype.hasPanel=function(){return this.panels&&this.panels.length>0},t}(Odin.ErrorState);e.Response=t;var n=function(){function e(e,t){void 0===t&&(t=null),this.key=e,this.file=t}return e}();e.TranslationItem=n;var i=function(){function t(){}return t.getInputId=function(e,t){return"input"+t+e.counter},t.findControlLabel=function(t,n){var i,r,o=n.getLeft(),a=n.getTop();for(r=0;r<t.length;r++)if(i=t[r],i.type===e.ControlType.label&&i.getTop()===a){var s=i.getLeft();if(s<o){var l=i.getWidth(),c=o-s-l;if(c<3)return i}}if(a--,a<=0)return null;for(r=0;r<t.length;r++)if(i=t[r],i.type===e.ControlType.label&&i.getTop()===a&&i.getLeft()===o)return i.isAdditionalInfo?null:i;return null},t.findAdditionalInfo=function(e,t){for(var n=t.getLeft()+t.getWidth(),i=t.getTop(),r=0;r<e.length;r++){var o=e[r];if(o.isAdditionalInfo){var a=o.getTop();if(a===i){var s=o.getLeft();if(s>=n&&s<=n+2)return o}}}return null},t.findControlAndLabels=function(e,n){var i=e.panels;if(i)for(var r=0;r<i.length;r++){var o=i[r],a=o.controls,s=a[n];if(s)return{control:s,label:t.findControlLabel(o.controlList,s),additionalInfo:t.findAdditionalInfo(o.controlList,s)}}return null},t}();e.FormUtil=i}(t=e.Form||(e.Form={}))}(M3||(M3={}));var M3;!function(e){var t;!function(t){var n=function(){function e(){}return e.gridOptions={isGrid:!0},e.defaultOptions={},e}();t.RenderOptions=n;var i=function(){function n(){this.cellWidth=10,this.cellHeight=25,this.defaultOptions={}}return n.prototype.gridWidth=function(e){return e*this.cellWidth},n.prototype.setSize=function(e,t,n){t&&e.css("width",t),n&&e.css("height",n)},n.prototype.addOptions=function(e,t){for(var n=t.items,i=0;i<n.length;i++){var r=n[i],o=$("<option/>").attr("value",r.value).text(r.text);e.append(o)}},n.prototype.span=function(e,t){var n=$("<span/>").text(e);return t&&n.addClass(t),n},n.prototype.div=function(e){var t=$("<div/>");return e&&t.addClass(e),t},n.prototype.row=function(){return this.div("row")},n.prototype.form=function(){return $("<form/>").attr("role","form").addClass("form-horizontal")},n.prototype.formGroup=function(){return this.div("form-group")},n.prototype.label=function(e,t){var n=$("<label/>").addClass("control-label");return e&&n.text(e),t&&n.attr("for",t),n},n.prototype.expander=function(t){return $("<odin-expander/>").attr("header",t).attr("is-expanded",e.Constants.scopeNameFormCtrl+".isHeaderExpanded")},n.prototype.getPath=function(e){return"controls."+e.name+".value"},n.prototype.getPathCombo=function(e){return"controls."+e.name+".value"},n.prototype.addBinding=function(e,t){e.attr("ng-model",this.getPath(t))},n.prototype.create=function(n,i,r,o){void 0===r&&(r=!0),void 0===o&&(o=null);var a,s=null,l=i.name,c=i.type,u=!0;if(o||(o=this.defaultOptions),c==t.ControlType.comboBox){s=$("<select/>").addClass("form-control");var d="i.value as i.text for i in controls."+l+".items";a=this.getPathCombo(i),s.attr("ng-model",a),s.attr("ng-options",d)}else if(c==t.ControlType.checkBox)s=$("<input/>").attr("type","checkbox").addClass("form-control");else if(c==t.ControlType.datePicker)s=$("<input/>").attr("type","text").addClass("form-control");else if(c==t.ControlType.label)s=this.label(i.value),o.isGrid&&s.addClass("m3-grid-label"),u=!1;else if(c==t.ControlType.button){var p=i;if(s=$("<button/>").addClass("btn btn-sm").text(p.value),p.command){var h=e.Constants.scopeNameFormCtrl+".executeCommand('"+p.command+"', '"+p.commandValue+"')";s.attr("ng-click",h)}u=!1}else s=$("<input/>").attr("type","text").addClass("form-control");if(s){r||s.attr(c==t.ControlType.textBox?"readonly":"disabled",""),u&&this.addBinding(s,i);var f=t.FormUtil.getInputId(n,l);s.attr("id",f)}return s},n.current=new n,n}();t.ControlFactory=i;var r=function(t){function i(){t.call(this),this.gridRows=23,this.fieldsToSkip="UPVR"}return __extends(i,t),i.prototype.reset=function(){this.maxX=-1,this.maxY=-1},i.prototype.getX=function(e){return e>this.maxX&&(this.maxX=e),e*this.cellWidth},i.prototype.getY=function(e){return e>this.maxY&&(this.maxY=e),e*this.cellHeight},i.prototype.setAbsoluteLayout=function(e,t){var n=e.position;this.setGridSize(t,n.width),t.css("left",this.getX(n.left-1)),t.css("position","absolute")},i.prototype.setGridSize=function(e,t,n){t&&e.css("width",this.getX(t)),n&&e.css("height",this.getY(n))},i.prototype.generateControl=function(e,t){var i=this.create(e,t,t.isEnabled,n.gridOptions);return this.setAbsoluteLayout(t,i),i},i.prototype.gridRow=function(){return this.div("m3-grid-row")},i.prototype.addElement=function(e,t,n){var i=(e.position.top-1).toString(),r=n[i];r||(r=this.gridRow(),n[i]=r),r.append(t)},i.prototype.addGridRows=function(e,t){for(var n=0;n<this.gridRows;n++){var i=t[n.toString()];if(i){var r=this.div("col-xs-12");r.append(i),e.append(r)}}},i.prototype.isIncluded=function(e){return e.isVisible&&!e.isSpecial&&e.name.indexOf("UPVR")<=0},i.prototype.setRelative=function(e){e.css("position","relative")},i.prototype.listViewRow=function(e){var t=e.panel,n=t.sortingOrderComboBox;n||(n=t.sortingOrderTextBox);var i=t.viewComboBox;if(i||(i=t.viewTextBox),!n&&!i)return null;var r=this.div("col-xs-12"),o=this.div("m3-grid-row pull-right");r.append(o);var a,s,l,c=200;return n&&(s=this.label("Sorting order:"),s.addClass("pull-left odin-margin-sm-r m3-grid-label"),o.append(s),a=this.create(e,n,n.isEnabled),this.setSize(a,c),l=this.div("pull-left odin-margin-md-r"),this.setSize(l,c),l.append(a),o.append(l)),i&&(s=this.label("View:"),s.addClass("pull-left odin-margin-sm-r m3-grid-label"),o.append(s),a=this.create(e,i,i.isEnabled),this.setSize(a,c),l=this.div("pull-left"),this.setSize(l,c),l.append(a),o.append(l)),r},i.prototype.createListHeader=function(e){for(var t=this.expander("Filter Options"),n={},i=e.panel.controlList,r=0;r<i.length;r++){var o=i[r];if(this.isIncluded(o)){var a=this.generateControl(e,o);this.addElement(o,a,n)}}var s=this.listViewRow(e);return s&&t.append(s),this.addGridRows(t,n),t},i.prototype.generateList=function(t,n){this.reset();var i=this.div(),r=n[e.Constants.scopeNameFormCtrl];r.isHeaderVisible&&i.append(this.createListHeader(t));var o=this.div("gridStyle");return o.attr("ng-if","!m3ListRefresh"),o.attr("ui-grid","gridOptions"),o.attr("ui-grid-selection",""),o.attr("ui-grid-resize-columns",""),o.attr("ui-grid-infinite-scroll",""),i.append(o),i},i.prototype.genereateListHeader=function(e){this.reset();var t=this.div();return t},i}(i);t.FormGenerator=r;var o=function(n){function i(t,i,r){void 0===r&&(r=null),n.call(this,t,i.odinService,r),this.formService=i,this.prefixFormCtrl="[M3.FormCtrl] ",this.instanceId=null,this.formScope=t,t[e.Constants.scopeNameFormCtrl]=this}return __extends(i,n),i.prototype.ctrlInit=function(){var e=this;this.setBusy(),this.formService.userService.getUserContext().then(function(t){e.userContext=t,e.setActive(),e.onUserContext(t);var n=e.formService.hasSession();e.formScope.hasSession=n,n&&e.onSession()}),n.prototype.ctrlInit.call(this)},i.prototype.beginExecute=function(){if(this.isBusy())throw"Execute is not allowed when the component context is busy";this.setBusy()},i.prototype.endExecute=function(){this.setActive()},i.prototype.hasUserContext=function(){var e=this.userContext;return e&&!(e.hasError&&e.hasError())},i.prototype.onUserContext=function(e){},i.prototype.onSession=function(){},i.prototype.onError=function(e){},i.prototype.onResponse=function(e){},i.prototype.error=function(e){this.setActive(),this.onError(e)},i.prototype.close=function(){this.beginExecute(),this.pressKey("F3")},i.prototype.logoff=function(){var e=this;this.formService.hasSession()&&(this.beginExecute(),this.formService.logoff().then(function(t){e.onResponse(t)}))},i.prototype.verifyContext=function(){if(!this.hasUserContext())throw"User context not initialized"},i.prototype.verifyInstance=function(){if(this.verifyContext(),!this.formService.hasSession()||!this.instanceId)throw"No program instance"},i.prototype.pressKey=function(e){this.executeCommand("KEY",e)},i.prototype.addValue=function(e,t){e&&e.value&&(t[e.name]=e.value)},i.prototype.getValue=function(e){return e.type==t.ControlType.comboBox?e.selected.value:e.value},i.prototype.addEditable=function(e,n){for(var i=e.controlList,r=0;r<i.length;r++){var o=i[r];if(o.isEnabled&&o.isVisible&&o.type!=t.ControlType.label){var a=this.getValue(o);a&&(n[o.name]=o.value)}}e.list&&(e.list.columns.forEach(function(e,t){null!=e.positionField&&(n[e.positionField.name]=e.positionField.value)}),this.addValue(e.sortingOrderComboBox,n),this.addValue(e.sortingOrderTextBox,n),this.addValue(e.viewComboBox,n),this.addValue(e.viewTextBox,n))},i.prototype.createParams=function(){return{IID:this.instanceId}},i.prototype.executeCommand=function(e,t){var n=this;this.verifyInstance();var i=this.createParams(),r=this.formScope.response;r&&r.hasPanel()&&this.addEditable(r.panel,i),this.formService.executeCommand(e,t,i).then(function(e){n.onResponse(e)})},i.prototype.executeBookmark=function(e){var t=this;this.verifyContext(),this.setBusy();var n=function(){t.formService.executeBookmark(e).then(function(e){t.setActive(),t.onResponse(e)},function(e){t.setActive(),t.onError(e)})};this.formService.hasSession()?n():this.formService.logon().then(function(){n()})},i.injectDefault=["$scope","m3FormService"],i}(Odin.BaseCtrl);t.FormCtrl=o;var a=function(e){function t(t,n,i){void 0===i&&(i=null),e.call(this,t,n,i),this.detailScope=t}return __extends(t,e),t.prototype.openBookmark=function(e){var t=this;return this.beginExecute(),e.isStateless=!0,e.includeStartPanel=!1,this.formService.hasSession()?void this.executeBookmark(e):void this.formService.logon().then(function(){return t.executeBookmark(e)},function(e){return t.onError(e)})},t.prototype.onResponse=function(e){if(this.setActive(),this.detailScope.hasSession=this.formService.hasSession(),this.instanceId||(this.instanceId=e.instanceId),this.detailScope.response=e,e.hasPanel()){this.detailScope.isProgramOpen=!0;var t=e.panel;if(this.detailScope.panel=t,e.panels){for(var n={},i=0;i<e.panels.length;i++){var r=e.panels[i].controls;angular.extend(n,r)}this.detailScope.controls=n}else this.detailScope.controls=t.controls}else this.detailScope.isProgramOpen=!1,this.detailScope.panel=null,this.detailScope.controls=null,e.message&&this.odinService.messageService.showWarning(e.message)},t}(o);t.DetailCtrl=a;var s=function(t){function n(e,n){t.call(this,e,n),this.prefixListCtrl="[M3.ListCtrl] ",this.isHeaderVisible=!1,this.isHeaderExpanded=!1,this.panelListDictionary={},this.deregisters=[],this.contextMenuOptions=[{option:"ContextMenu"}],this.contextMenuRelatedOptions=[],this.contextMenuStyle={left:"0",top:"0",position:"absolute","z-index":"40"},this.contextMenu={isOpen:!1},this.selectedListItem={},this.baseBookmark=null,this.pendingBookmark=null,this.isFirst=!0}return __extends(n,t),n.prototype.initialize=function(e,t){var n=this;e=Odin.DefaultListCtrlOptions.get(e),this.listOptions=e;var i=e.gridOptions;i||(i={}),i.data||(i.data=e.scopeNameGridData),i.multiSelect!==!0&&(i.multiSelect=!1),i.enableColumnResize!==!1&&(i.enableColumnResize=!0),i.enableSorting!==!0&&(i.enableSorting=!1),i.enableRowSelection=!0,i.enableRowHeaderSelection=!1,i.enableGridMenu=!1,i.infiniteScroll=10,i.enableFiltering=!0,i.useExternalFiltering=!0;var r=function(e){n.executeCommand("KEY","ENTER")};i.plugins=[r],i.onRegisterApi||(i.onRegisterApi=function(e){n.gridApi=e,e.selection.on.rowSelectionChanged(n.formScope,function(e){n.rowSelectionChanged(e)}),e.infiniteScroll.on.needLoadMoreData(n.formScope,function(){n.loadMoreRows()})}),this.formScope[e.scopeNameGridOptions]=i},n.prototype.destroyList=function(){},n.prototype.getItems=function(e){return this.panelListDictionary[e]},n.prototype.setItems=function(e,t){this.formScope[this.listOptions.scopeNameGridData]=e,t?this.panelListDictionary[t]=e:this.panelListDictionary={}},n.prototype.initializeList=function(e){for(var t=this,n=0,i=this.deregisters;n<i.length;n++){var r=i[n];r()}var o=this,a=function(){o.formScope.m3ListRefresh=!1;var n=e.list,i={gridOptions:{enableColumnMenus:!1,columnDefs:t.createColumns(n.columns)}};o.initialize(i,e),n.isCleared&&o.setItems(n.items,n.name)};return this.isFirst?(this.isFirst=!1,void a()):(this.formScope.m3ListRefresh=!0,void this.formService.timeout(a,0))},n.prototype.loadMoreRows=function(){var e=this;this.isPaging||this.isEndOfList||!this.programInstance||this.isBusy()||(this.beginExecute(),this.isPaging=!0,this.programInstance.executeCommand("PAGE","DOWN").then(function(t){e.onResponse(t)}))},n.prototype.onClickOption=function(e){this.executeOption(e,this.selectedListItem)},n.prototype.executeOption=function(e,t){var n=this.baseBookmark.keyNames,i=n?n.split(","):[],r=this.baseBookmark.values,o={};i.forEach(function(e,t){o[e.substring(-1,4)]=r[e]})},n.prototype.onSelectedItemChanged=function(e){},n.prototype.rowSelectionChanged=function(e,t){var n=e.isSelected?e.entity:null;this.selectedListItem=n,this.getComponentContext().isActive()?this.onSelectedItemChanged(n):(Odin.Log.debug(this.prefixListCtrl+"Selection changed event delayed"),this.pendingItem=e,this.pendingEvent=t)},n.prototype.onActive=function(e){e&&this.pendingItem&&(Odin.Log.debug(this.prefixListCtrl+"Delivering delayed selection changed event"),this.rowSelectionChanged(this.pendingItem,this.pendingEvent),this.pendingItem=null,this.pendingEvent=null)},n.prototype.openBookmark=function(e){var t=this;return this.formScope.isProgramOpen?(this.pendingBookmark=e,void this.close()):(this.beginExecute(),this.formService.hasSession()?(this.baseBookmark=e,void this.executeBookmark(e)):void this.formService.logon().then(function(){return t.executeBookmark(e)},function(e){return t.onError(e)}))},n.prototype.onResponse=function(t){return this.setActive(),this.formScope.hasSession=this.formService.hasSession(),this.instanceId||(this.instanceId=t.instanceId),t.hasPanel()?(this.formScope.isProgramOpen?t.panel.list&&("PAGE"!=t.request.commandType&&this.initializeList(t.panel),this.updateListRows(t.panel.list)):(this.formScope.isProgramOpen=!0,this.programInstance=new e.ProgramInstance(this.formService,t.instanceId),t.panel.list&&this.initializeList(t.panel)),this.formScope.response=t,void(this.formScope.controls=t.panel.controls)):(this.onProgramClosed(),t.message&&alert(t.message),void(this.pendingBookmark&&(this.openBookmark(this.pendingBookmark),this.pendingBookmark=null)))},n.prototype.onProgramClosed=function(){this.formScope.isProgramOpen=!1,this.programInstance=null,this.isEndOfList=!1,this.isPaging=!1,this.setItems([])},n.prototype.updateListRows=function(e){var t=this.getItems(e.name),n=e.items,i=n.length;if(0==i)return void(this.isEndOfList=!0);for(var r=0;r<i;r++)t.push(n[r]);Odin.Log.debug(this.prefixListCtrl+"Added "+i+" list rows."),this.isPaging&&(this.gridApi.infiniteScroll.dataLoaded(),this.isPaging=!1)},n.prototype.createColumns=function(e){var t=this,n=[],i="<div odin-keypress=\"{'enter': 'grid.options.plugins[0]($event)'}\" >",r=i+'<div ng-class="{ \'sortable\': sortable }"><div class="ui-grid-vertical-bar">&nbsp;</div><div class="ui-grid-cell-contents" col-index="renderIndex">{{ col.displayName CUSTOM_FILTERS }} <span ui-grid-visible="col.sort.direction" ng-class="{ \'ui-grid-icon-up-dir\': col.sort.direction == asc, \'ui-grid-icon-down-dir\': col.sort.direction == desc, \'ui-grid-icon-blank\': !col.sort.direction }">&nbsp;</span></div><div class="ui-grid-column-menu-button" ng-if="grid.options.enableColumnMenus && !col.isRowHeader  && !col.colDef.disableColumnMenu" class="ui-grid-column-menu-button" ng-click="toggleMenu($event)"><i class="ui-grid-icon-angle-down">&nbsp;<i></i></i></div><div ng-if="filterable" class="ui-grid-filter-container" ng-repeat="colFilter in col.filters"><input type="text" class="ui-grid-filter-input" ng-model="colFilter.term" ng-click="$event.stopPropagation()" ng-attr-placeholder="{{colFilter.placeholder || \'\'}}" ><div class="ui-grid-filter-button" ng-click="colFilter.term = null"><i class="ui-grid-icon-cancel right" ng-show="!!colFilter.term">&nbsp;</i> <!-- use !! because angular interprets \'f\' as false --></div></div></div></div>';return e.forEach(function(e,i){var o=10*e.width;o<50&&(o=50);var a=null!=e.positionField;t.formScope[e.fullName]="";var s={field:e.fullName,name:e.fullName,enableFiltering:a,filter:a?{term:e.positionField.value||""}:null,headerCellTemplate:a?r:null,displayName:e.header,width:o,enableSorting:!1,resizable:!0};if(null!=e.positionField){var l="gridOptions.columnDefs["+i+"].filter.term";t.deregisters.push(t.formScope.$watch(l,function(t,n){e.positionField.value=t}))}n.push(s)}),n},n}(o);t.ListCtrl=s;var l=function(){function e(){}return e.add=function(t){t.directive("m3FieldLabel",["$compile",function(t){return{scope:!1,link:function(n,i,r,o,a){n.$watch("response",function(o){e.update(o,t,n,i,r)})}}}])},e.update=function(e,n,i,r,o){if(e&&e.panel){var a=o.m3FieldLabel;if(a){var s=t.FormUtil.findControlAndLabels(e,a);s&&s.label&&(r.text(s.label.value),r.attr("for",t.FormUtil.getInputId(e,a)))}}},e}();t.FieldLabelDirective=l;var c=function(){function e(){}return e.add=function(t){t.directive("m3FieldInfo",["$compile",function(t){return{scope:!1,link:function(n,i,r,o,a){n.$watch("response",function(o){e.update(o,t,n,i,r)})}}}])},e.update=function(e,n,i,r,o){if(e&&e.panel){var a=o.m3FieldInfo;if(a){var s=t.FormUtil.findControlAndLabels(e,a);s&&s.additionalInfo&&r.text(s.additionalInfo.value)}}},e}();t.FieldInfoDirective=c;var u=function(){function e(){}return e.add=function(t){t.directive("m3FieldPresenter",["$compile",function(t){return{scope:!1,link:function(n,i,r,o,a){n.$watch("response",function(o){e.update(o,t,n,i,r)})}}}])},e.update=function(e,n,r,o,a){if(e&&e.panel){var s=a.m3FieldPresenter;if(s){var l=Odin.Util.getBoolean(a.m3Enabled,!1),c=t.FormUtil.findControlAndLabels(e,s);if(c&&c.control){var u=i.current.create(e,c.control,l);o.append(n(u)(r))}}}},e}();t.FieldPresenterDirective=u;var d=function(){function e(){}return e.add=function(t){t.directive("m3List",["$compile",function(t){return{scope:!1,restrict:"E",link:function(n,i,r,o,a){n.$watch("response",function(o){e.update(o,t,n,i,r)})}}}])},e.update=function(e,t,n,i,o){if(e&&e.panel&&"PAGE"!==e.request.commandType){i.empty();var a=new r,s=a.generateList(e,n);i.append(t(s)(n))}},e}();t.ListDirective=d;var p=function(){function e(){}return e.add=function(t){t.directive("m3DetailLayout",["$compile",function(t){return{scope:!1,restrict:"E",link:function(n,i,r,o,a){n.$watch("response",function(o){e.update(o,t,n,i,r)})}}}])},e.update=function(e,n,r,o,a){if(e&&e.panel){var s=null,l=a.fields;if(l&&(s=l.split(",")),s){var c=Odin.NumUtil.getInt(a.columns,1);c<0&&(c=1),c>4&&(c=4);var u=a.enabledFields,d=Odin.Util.getBoolean(a.enable,!1),p=Odin.Util.getBoolean(a.additional,!0),h=Odin.Util.getBoolean(a.absolute,!1),f=!1,g=a.labelAlign;g&&"l"==g.charAt(0)&&(f=!0);var v=12,m=v,y=3,b=p&&!h?6:9,S=0;y=Odin.NumUtil.getInt(a.labelSize,y),b=Odin.NumUtil.getInt(a.fieldSize,b),p&&(S=3,S=Odin.NumUtil.getInt(a.additionalSize,S));var C=y+b+S;C>v&&Odin.Log.warning("[m3-detail-layout] Invalid total size "+C);var x="col-md-",I=i.current,w=I.form();o.empty(),o.append(w),4==c?m=3:3==c?m=4:2==c&&(m=6);var E=I.row();w.append(E);for(var O=0,M=0;M<s.length;M++){var L=I.div(x+m);E.append(L);var D=I.formGroup();L.append(D);var A,B,P=s[M].trim(),R="BLANK"==P,k=R?null:t.FormUtil.findControlAndLabels(e,P);if(k&&k.control){var N=t.FormUtil.getInputId(e,P);B=x+y,k.label?(A=I.label(k.label.value,N),A.addClass(B),f&&A.addClass("odin-align-l"),D.append(A)):D.append(I.div(B)),B=x+b;var F=k.control,T=d;!T&&u&&u.indexOf(F.name)>=0&&(T=!0);var U=I.create(e,F,T);h&&I.setSize(U,I.gridWidth(F.position.width));var $=I.div(B);$.append(n(U)(r)),D.append($);var _=k.additionalInfo;if(p&&_){var V=_.value;V&&(A=I.label("{{"+I.getPath(_)+"}}"),A.addClass("odin-additional-label"),h?(U.addClass("pull-left"),A.addClass("odin-padding-md-l"),$.append(n(A)(r))):(B=x+S,A.addClass(B),D.append(n(A)(r))))}}else B=x+v,L.append(I.div(B));O++,O>=c&&(E=I.row(),w.append(E),O=0)}}}},e}();t.DetailLayoutDirective=p;var h=function(e){function t(t,n,i,r,o){var a=this;e.call(this,t,i),this.scope=t,this.modalInstance=n,this.miService=i,this.languageService=r,this.browseConfiguration=o,this.selectedItem=null,this.registerComponent({scope:this.scope});var s=r.tryGet();if(t.lang=s,this.browseConfiguration){var l={header:this.browseConfiguration.header,message:this.browseConfiguration.message},c={enableGridInfiniteScroll:!1,gridOptions:this.browseConfiguration.gridOptions,scopeNameGridOptions:"gridOptions"};this.initialize(c),this.scope.options=l,this.scope.gridOptions=c.gridOptions}else Odin.Log.error("Missing browseConfiguration");this.scope.ok=function(){a.ok()},this.scope.cancel=function(){a.cancel()}}return __extends(t,e),t.add=function(e){e.controller("MIBrowseCtrl",t)},t.prototype.onSelectedItemChanged=function(e){this.selectedItem=e},t.prototype.onReady=function(){if(this.browseConfiguration){var e=this.browseConfiguration.serviceConfigration;e.record=this.browseConfiguration.data,this.executeRequest(e)}},t.prototype.ok=function(){this.modalInstance.close(this.selectedItem)},t.prototype.cancel=function(){this.modalInstance.close(null)},t.$inject=["$scope","$uibModalInstance","m3MIService","odinLanguageService","browseConfiguration"],t}(e.MIListCtrl);t.MIBrowseCtrl=h;var f=function(){function t(e,t,n){this.$modal=e,this.$q=t,this.miService=n,this.configurations={},this.defaultSettings={backdrop:!0,keyboard:!0,modalFade:!0,templateUrl:"odin/partials/modalMessage.html"}}return t.add=function(e){e.service("m3BrowseService",t)},t.prototype.register=function(e){this.configurations[e.name]=e},t.prototype.browse=function(t,n){var i=this.configurations[t];if(i){var r=new e.BrowseConfiguration;angular.copy(i,r),r.data=n;var o;if(i.serviceType!==e.BrowseServiceType.MI){var a=i.serviceType+" is not supported";throw Odin.Log.error(a),a}o=h;var s=this.$modal.open({templateUrl:Odin.BrowseConstants.browseGridTemplateName,controller:o,backdrop:"static",resolve:{browseConfiguration:function(){return r}}}).result;return s}var l=this.$q.defer();return l.reject("Configuration "+t+" does not exist."),l.promise},t.$inject=["$uibModal","$q","m3MIService"],t}();t.BrowseService=f}(t=e.Form||(e.Form={}))}(M3||(M3={}));var M3;!function(e){var t;!function(e){var t=function(){function t(){}return t.prototype.translate=function(e){for(var n=e.language,i=this.getLanguage(n),r="",o=e.items,a=0;a<o.length;a++){var s=o[a];if(s.text=null,s.key){s.language=n;var l=this.getKey(s),c=i[l];c?s.text=c:(s.file||(s.file=t.defaultFile),r.indexOf(l)<0&&(r+=l+","))}}if(0==r.length)return null;var u={items:o,constants:r,language:n,params:{LANC:n,CONSTANTS:r},commandType:"FNC",commandValue:"TRANSLATE"};return u},t.prototype.parseResponse=function(t,n){var i=e.Parser.parseXml(n),r=e.Parser.selectRoot(i);if(r){var o=i.getElementsByTagName("Text");if(o)for(var a=0;a<o.length;a++){var s=o[a],l=e.XmlUtil.getAttribute(s,"file"),c=e.XmlUtil.getAttribute(s,"key"),u=s.textContent;this.updateItem(t.items,t.language,l,c,u)}}},t.prototype.getKey=function(e){return e.file||(e.file=t.defaultFile),e.file+":"+e.key},t.prototype.addToCache=function(e,t){var n=this.getLanguage(e);n[this.getKey(t)]=t.text},t.prototype.getLanguage=function(e){var n=t.languages[e];return n||(n={},t.languages[e]=n),n},t.prototype.updateItem=function(e,t,n,i,r){for(var o=0;o<e.length;o++){var a=e[o];i===a.key&&n===a.file&&(a.language=t,a.text||(a.text=r,this.addToCache(t,a)))}},t.defaultFile="MVXCON",t.languages={},t}();e.Translator=t}(t=e.Form||(e.Form={}))}(M3||(M3={}));var M3;!function(e){var t=function(){function t(e,t,n,i){this.http=e,this.q=t,this.timeout=n,this.odinService=i,this.logPrefix="[MIService] "}return t.add=function(e){e.service("m3MIService",t)},t.prototype.overrideUrl=function(e){this._overrideUrl=e},t.prototype.getBaseUrl=function(){return this._overrideUrl?this._overrideUrl:e.Configuration.getUrl()},t.prototype.createRequest=function(e,t,n,i){var r={program:e,transaction:t,record:angular.copy(n)};return null!=i&&i.length>0&&(r.outputFields=i),r},t.prototype.executeRequest=function(t){var n=this,i=e.MIAccess.createUrl(this.getBaseUrl(),t),r=this.q.defer();return Odin.Log.isDebug()&&Odin.Log.debug(this.logPrefix+"Executing MI URL "+i),this.http({method:"GET",url:i,cache:!1}).then(function(o){try{var a=e.MIAccess.parseResponse(t,o.data);a.hasError()?(a.errorType=e.M3ErrorTypes.MI,r.reject(a)):r.resolve(a)}catch(t){n.logError("Failed to parse response for "+i);var s=new e.MIResponse;s.error=t,s.errorType=Odin.ErrorTypes.parse,r.reject(s)}},function(i){var o=new e.MIResponse,a=i.status,s="Failed to call "+t.program+"."+t.transaction+" "+a;o.errorMessage=s,o.errorCode=a,o.errorType=Odin.ErrorTypes.http,n.logError(s),r.reject(o)}),r.promise},t.prototype.logError=function(e){Odin.Log.error(this.logPrefix+e)},t.prototype.execute=function(e,t,n,i){return this.executeRequest(this.createRequest(e,t,n,i))},t.$inject=["$http","$q","$timeout","odinService"],t}(),n=function(e){function t(){e.call(this),this.numberFormatOptions={separator:"."}}return __extends(t,e),t.current=new t,t}(Odin.ErrorState);e.UserContext=n;var i=function(){function t(e,t,n,i){this.$http=e,this.$q=t,this.$timeout=n,this.miService=i,this.isUserContextAvailable=!0,this.queue=[],this.isExecuting=!1,this.isH5Host=!1,this.isMessagePending=!1,this.sessionId=null,this.init()}return t.add=function(e){e.service("m3UserService",t)},t.prototype.isH5=function(){return this.isH5Host},t.prototype.getSesssionId=function(){return this.sessionId},t.prototype.init=function(){var e=this;if(Odin.Util.isIframe()){this.registerMessage();var t={m3Command:"user"};this.$timeout(function(){return e.onTimeout()},500),this.isMessagePending=!0,this.isExecuting=!0,this.sendMessage(t)}},t.prototype.onTimeout=function(){this.isMessagePending&&(this.isMessagePending=!1,this.isExecuting=!1,this.queue.length>0&&this.loadUserId())},t.prototype.onMessage=function(e){var t=angular.fromJson(e);if("user"===t.m3Command){var n=t.m3Response;this.m3User=n.m3User,this.principalUser=n.principalUser,this.isMessagePending=!1,this.isH5Host=!0,this.sessionId=n.sessionId;var i=this.createUserContext(n.userContext);this.setContext(i)}},t.prototype.registerMessage=function(){var e=this,t=window.addEventListener?"addEventListener":"attachEvent",n=window[t],i="attachEvent"==t?"onmessage":"message";n(i,function(t){var n=t.message?"message":"data",i=t[n];e.onMessage(i)},!1)},t.prototype.sendMessage=function(e){parent.postMessage(angular.toJson(e),"*")},t.prototype.createErrorContext=function(e){var t=new n;t.errorMessage=e,this.userContext=t},t.prototype.processQueue=function(e){var t=this.queue;this.queue=[];for(var n=0;n<t.length;n++){var i=t[n];e?i.resolve(this.userContext):i.reject(this.userContext)}this.isExecuting=!1},t.prototype.rejectQueue=function(e){this.createErrorContext(e),this.processQueue(!1)},t.prototype.parseUser=function(e){for(var t=e.split("\n"),n=0;n<t.length;n++){var i=t[n];if(i.indexOf("User:")>0&&i.indexOf("GridPrincipal")>=0){var r=i.split(":");return r.length>1?r[r.length-1].trim():null}}return null},t.prototype.onGridUser=function(e){var n=this.parseUser(e.data);n?(this.principalUser=n,this.m3User=n.toUpperCase(),Odin.Log.debug(t.logPrefix+"Loaded user "+this.m3User),this.loadUserData()):(this.isUserContextAvailable=!1,Odin.Log.warning(t.logPrefix+"User not found. Status "+e.status),this.rejectQueue("User not available"))},t.prototype.loadUserId=function(){var n=this;if(!this.isExecuting){this.isExecuting=!0;var i=e.Configuration.getUrl()+"/grid/user";Odin.Log.debug(t.logPrefix+"Loading user from "+i),this.$http({method:"GET",url:i}).then(function(e){n.onGridUser(e)},function(e){n.onGridUser(e)})}},t.prototype.addAliases=function(t){t.m3User=t.USID,t.M3User=t.USID,t.company=t.CONO,t.Company=t.CONO,t.currentCompany=t.CONO,t.CurrentCompany=t.CONO,t.division=t.DIVI,t.Division=t.DIVI,t.currentDivision=t.DIVI,t.CurrentDivision=t.DIVI,t.language=t.LANC,t.Language=t.LANC,t.currentLanguage=t.LANC,t.CurrentLanguage=t.LANC,t.dateFormat=e.Configuration.getDateFormat(t.DTFM),t.languageTag=e.Configuration.getLanguageTag(t.LANC),t.numberFormatOptions={separator:t.DCFM}},t.prototype.setContext=function(e){this.m3User=e.USID,e.principalUser=this.principalUser,this.addAliases(e),this.userContext=e,n.current=e,this.processQueue(!0),Odin.Log.info("[UserService] Initialized user context for "+this.m3User+" "+e.currentCompany+"/"+e.currentDivision)},t.prototype.onUserData=function(e){var t=this.createUserContext(e);this.setContext(t)},t.prototype.createUserContext=function(e){var t=new n;return angular.extend(t,e),
t},t.prototype.loadUserData=function(){var e=this,t={},n=this.m3User;n.length<=10&&(t={USID:n}),this.miService.execute("MNS150MI","GetUserData",t).then(function(t){e.onUserData(t.item)},function(t){e.rejectQueue(t.errorMessage)})},t.prototype.getUserContext=function(){var e=this.$q.defer();return this.isUserContextAvailable?this.userContext?e.resolve(this.userContext):(this.queue.push(e),this.loadUserId()):(this.createErrorContext("M3 UserContext not available"),e.reject(this.userContext)),e.promise},t.$inject=["$http","$q","$timeout","m3MIService"],t.logPrefix="[M3.UserService] ",t}();e.UserService=i;var r=function(){function e(e,t){this.formService=e,this.instanceId=t}return e.prototype.pressKey=function(e,t){return this.executeCommand(e,null,t)},e.prototype.close=function(){return this.pressKey("F3")},e.prototype.executeCommand=function(e,t,n){var i={commandType:e,commandValue:t,params:n,instanceId:this.instanceId};return this.formService.execute(i)},e}();e.ProgramInstance=r;var o=function(){function t(e,t,n,i,r,o){var a=this;this.rootScope=e,this.http=t,this.q=n,this.timeout=i,this.odinService=r,this.userService=o,window.addEventListener("unload",function(){a.onUnload()},!1)}return t.add=function(e){e.service("m3FormService",t)},t.prototype.overrideUrl=function(e){this._overrideUrl=e},t.prototype.getBaseUrl=function(){return(this._overrideUrl?this._overrideUrl:e.Configuration.getUrl())+"/mne/servlet/MvxMCSvt"},t.prototype.onUnload=function(){!this.userService.isH5()&&this.hasSession()&&(this.logoffSync(),this.sessionId=null)},t.prototype.executeSync=function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!1),t.send(null)}catch(e){}},t.prototype.logoffSync=function(){var e=this.getBaseUrl()+"?CMDTP=QUIT&SID="+this.sessionId+"&RID="+Odin.Util.random();this.sessionId=null,this.executeSync(e)},t.prototype.launch=function(e){var t={link:e},n={m3Command:"launch",m3Parameter:t};this.userService.sendMessage(n)},t.prototype.hasSession=function(){return this.sessionId||(this.sessionId=this.userService.getSesssionId()),null!=this.sessionId},t.prototype.parseResponse=function(t,n){var i=e.Form.Parser.parse(n);return i.request=t,this.sessionId||(this.sessionId=i.sessionId),i},t.prototype.getUserContext=function(){return this.userService.getUserContext()},t.prototype.logon=function(){var t=this,n=this.q.defer();if(this.hasSession()){var i=new e.Form.Response;i.sessionId=this.sessionId,n.resolve(i)}else this.userService.getUserContext().then(function(e){t.userContext=e,t.command("LOGON",null).then(function(e){n.resolve(e)},function(e){n.reject(e)})});return n.promise},t.prototype.logoff=function(){var e=this.command("QUIT",null);return this.sessionId=null,e},t.prototype.ping=function(){return this.command("FNC","PING")},t.prototype.command=function(e,t){var n={commandType:e};return t&&(n.commandValue=t),this.sessionId&&(n.sessionId=this.sessionId),this.execute(n)},t.prototype.addParam=function(e,t,n){n&&(e[t]=n)},t.prototype.createParams=function(e){var t={};return e.params&&angular.extend(t,e.params),this.addParam(t,"CMDTP",e.commandType),this.addParam(t,"CMDVAL",e.commandValue),this.addParam(t,"SID",e.sessionId),this.addParam(t,"IID",e.instanceId),this.addParam(t,"RID",Odin.Util.random()),t},t.prototype.createError=function(n){Odin.Log.error(t.logPrefix+"Failed to execute request");var i=new e.Form.Response;return i.result=-1,i},t.prototype.createOptions=function(e){return{method:"POST",cache:!1,url:this.getBaseUrl(),params:this.createParams(e)}},t.prototype.executeBookmark=function(t){var n={commandType:"RUN",commandValue:"BOOKMARK",params:e.Form.Bookmark.toParams(t,this.userContext)};return this.execute(n)},t.prototype.pressKey=function(e,t){return this.executeCommand(e,null,t)},t.prototype.executeCommand=function(e,t,n){var i={commandType:e,commandValue:t,params:n};return this.execute(i)},t.prototype.destroyProgram=function(e){return this.pressKey("F3")},t.prototype.execute=function(e){var n=this,i=this.q.defer();e.sessionId||(e.sessionId=this.sessionId),Odin.Log.debug(t.logPrefix+"Executing request "+e.commandType);var r=this.createOptions(e);return this.http(r).then(function(t){i.resolve(n.parseResponse(e,t.data))},function(e){i.reject(n.createError(e))}),i.promise},t.prototype.executeUrl=function(e){var t=this.q.defer();return this.http({method:"GET",url:e}).then(function(e){t.resolve(e.data)},function(e){t.resolve(null)}),t.promise},t.prototype.onTranslate=function(e,t){return this.translator.parseResponse(e,t),e.params=null,e},t.prototype.translate=function(t){var n=this,i=this.q.defer();this.translator||(this.translator=new e.Form.Translator);var r=this.translator.translate(t);if(r){r.sessionId=this.sessionId;var o=this.createOptions(r);this.http(o).then(function(e){i.resolve(n.onTranslate(r,e.data))},function(e){i.reject(n.createError(e))})}else i.resolve(t);return i.promise},t.logPrefix="[M3.FormService] ",t.$inject=["$rootScope","$http","$q","$timeout","odinService","m3UserService"],t}();e.FormService=o;var a=function(){function t(){}return t.add=function(t){t.filter("m3Date",["$filter",function(t){return function(i){if(null===i)return null;if("undefined"===i)return null;var r=n.current.dateFormat;return r||(r=e.Constants.dateFormat),t("date")(i,r)}}])},t}(),s=function(){function e(){}return e.add=function(e){e.filter("m3Number",function(){return function(e){return Odin.NumUtil.format(e)}})},e}(),l=function(){function e(e,t,n){this.miService=e,this.userService=t,this.formService=n}return e.add=function(t){t.service("m3Service",e)},e.$inject=["m3MIService","m3UserService","m3FormService"],e}();e.Service=l;var c=function(t){function n(e,n,i,r,o){t.call(this,e,n,i,r),this.m3Service=o,this.logPrefix="[M3.StartupService] "}return __extends(n,t),n.add=function(e){e.service("m3StartupService",n)},n.prototype.getResolvedPromise=function(e){var t=this.q.defer();return t.resolve(e),t.promise},n.prototype.start=function(n){var i=this;if(this.isReady())throw this.raiseReady();n||(n={userContext:!0,useM3Language:!0}),n.session&&(n.userContext=!0);var r;n.useM3Language&&(n.userContext=!0,r=n.languageOptions,r||(n.languageOptions=r={})),t.prototype.initialize.call(this,n);var o=this.getUrlOverride("M3");o&&e.Configuration.overrideUrl(o);var a=this.q.defer(),s=function(){return n.userContext?i.m3Service.userService.getUserContext().then(function(e){return e}):i.getResolvedPromise(null)},l=function(e){return n.useM3Language&&!r.language&&(r.language=e.languageTag),t.prototype.start.call(i,n)},c=function(){return n.session?i.m3Service.formService.logon().then(function(e){return e}):i.getResolvedPromise(null)};return s().then(l).then(c).then(function(){i.resolveReady(a)},function(e){i.rejectReady(a,e)}),a.promise},n.$inject=["$rootScope","$q","$location","odinService","m3Service"],n}(Odin.StartupService);e.StartupService=c;var u=function(e){function t(){e.call(this),this.startupServiceName="m3StartupService"}return __extends(t,e),t.prototype.getStartupOptions=function(){var t=e.prototype.getStartupOptions.call(this);return t.userContext=this.userContext,t.session=this.session,t.useM3Language=this.useM3Language,t},t}(Odin.ApplicationBase);e.ApplicationBase=u;var d=function(){function n(){}return n.init=function(){var n=angular.module("m3",["odin"]);t.add(n),i.add(n),o.add(n),e.Form.BrowseService.add(n),l.add(n),c.add(n),e.Form.MIBrowseCtrl.add(n),a.add(n),s.add(n),e.Form.DetailLayoutDirective.add(n),e.Form.FieldLabelDirective.add(n),e.Form.FieldInfoDirective.add(n),e.Form.FieldPresenterDirective.add(n),e.Form.ListDirective.add(n)},n}();d.init()}(M3||(M3={}));